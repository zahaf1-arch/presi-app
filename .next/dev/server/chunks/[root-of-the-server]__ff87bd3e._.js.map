{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///D:/ELECTION/SiteRAG/presiapp/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient }\n\nexport const prisma =\n  globalForPrisma.prisma ||\n  new PrismaClient({\n    log: ['query'],\n  })\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;KAAQ;AAChB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///D:/ELECTION/SiteRAG/presiapp/app/api/candidates/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { prisma } from \"@/lib/prisma\"\nimport jwt from \"jsonwebtoken\"\n\n// GET ➤ liste candidats actifs\nexport async function GET() {\n  try {\n    const candidates = await prisma.candidat.findMany({\n      where: { actif: true },\n      orderBy: { id: \"asc\" },\n    })\n    return NextResponse.json(candidates)\n  } catch (error) {\n    console.error(\"GET candidats error:\", error)\n    return NextResponse.json({ error: \"Failed to fetch candidates\" }, { status: 500 })\n  }\n}\n\n// POST ➤ créer candidat (ADMIN ONLY)\nexport async function POST(request: NextRequest) {\n  try {\n    const token = request.cookies.get(\"token\")?.value\n    if (!token) return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\n\n    const decoded: any = jwt.verify(token, process.env.JWT_SECRET!)\n    if (!decoded.role || decoded.role.toLowerCase() !== \"admin\") {\n      return NextResponse.json({ error: \"Forbidden\" }, { status: 403 })\n    }\n\n    const { nom_fr, nom_ar, couleur, photo, logo } = await request.json()\n\n    const created = await prisma.candidat.create({\n      data: {\n        nom_fr,\n        nom_ar,\n        couleur,\n        photo,   // peut être null ou \"/uploads/xxx.png\"\n        logo,\n        actif: true,\n      },\n    })\n\n    return NextResponse.json(created, { status: 201 })\n  } catch (error) {\n    console.error(\"POST candidat error:\", error)\n    return NextResponse.json({ error: \"Failed to create\" }, { status: 500 })\n  }\n}\n\n// PUT ➤ modifier candidat (ADMIN ONLY)\nexport async function PUT(request: NextRequest) {\n  try {\n    const token = request.cookies.get(\"token\")?.value\n    if (!token) return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\n\n    const decoded: any = jwt.verify(token, process.env.JWT_SECRET!)\n    if (!decoded.role || decoded.role.toLowerCase() !== \"admin\") {\n      return NextResponse.json({ error: \"Forbidden\" }, { status: 403 })\n    }\n\n    const { id, nom_fr, nom_ar, couleur, photo, logo } = await request.json()\n\n    const updated = await prisma.candidat.update({\n      where: { id },\n      data: {\n        nom_fr,\n        nom_ar,\n        couleur,\n        photo,\n        logo,\n      },\n    })\n\n    return NextResponse.json(updated)\n  } catch (error) {\n    console.error(\"PUT candidat error:\", error)\n    return NextResponse.json({ error: \"Failed to update\" }, { status: 500 })\n  }\n}\n\n// DELETE ➤ désactiver candidat (soft delete)\nexport async function DELETE(request: NextRequest) {\n  try {\n    const token = request.cookies.get(\"token\")?.value\n    if (!token) return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\n\n    const decoded: any = jwt.verify(token, process.env.JWT_SECRET!)\n    if (!decoded.role || decoded.role.toLowerCase() !== \"admin\") {\n      return NextResponse.json({ error: \"Forbidden\" }, { status: 403 })\n    }\n\n    const { id } = await request.json()\n\n    await prisma.candidat.update({\n      where: { id },\n      data: { actif: false },\n    })\n\n    return NextResponse.json({ success: true })\n  } catch (error) {\n    console.error(\"DELETE candidat error:\", error)\n    return NextResponse.json({ error: \"Failed to delete\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AACA;;;;AAGO,eAAe;IACpB,IAAI;QACF,MAAM,aAAa,MAAM,yHAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC;YAChD,OAAO;gBAAE,OAAO;YAAK;YACrB,SAAS;gBAAE,IAAI;YAAM;QACvB;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA6B,GAAG;YAAE,QAAQ;QAAI;IAClF;AACF;AAGO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,UAAU;QAC5C,IAAI,CAAC,OAAO,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;QAE9E,MAAM,UAAe,kJAAG,CAAC,MAAM,CAAC,OAAO,QAAQ,GAAG,CAAC,UAAU;QAC7D,IAAI,CAAC,QAAQ,IAAI,IAAI,QAAQ,IAAI,CAAC,WAAW,OAAO,SAAS;YAC3D,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAY,GAAG;gBAAE,QAAQ;YAAI;QACjE;QAEA,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEnE,MAAM,UAAU,MAAM,yHAAM,CAAC,QAAQ,CAAC,MAAM,CAAC;YAC3C,MAAM;gBACJ;gBACA;gBACA;gBACA;gBACA;gBACA,OAAO;YACT;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC,SAAS;YAAE,QAAQ;QAAI;IAClD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAmB,GAAG;YAAE,QAAQ;QAAI;IACxE;AACF;AAGO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,UAAU;QAC5C,IAAI,CAAC,OAAO,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;QAE9E,MAAM,UAAe,kJAAG,CAAC,MAAM,CAAC,OAAO,QAAQ,GAAG,CAAC,UAAU;QAC7D,IAAI,CAAC,QAAQ,IAAI,IAAI,QAAQ,IAAI,CAAC,WAAW,OAAO,SAAS;YAC3D,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAY,GAAG;gBAAE,QAAQ;YAAI;QACjE;QAEA,MAAM,EAAE,EAAE,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEvE,MAAM,UAAU,MAAM,yHAAM,CAAC,QAAQ,CAAC,MAAM,CAAC;YAC3C,OAAO;gBAAE;YAAG;YACZ,MAAM;gBACJ;gBACA;gBACA;gBACA;gBACA;YACF;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAmB,GAAG;YAAE,QAAQ;QAAI;IACxE;AACF;AAGO,eAAe,OAAO,OAAoB;IAC/C,IAAI;QACF,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,UAAU;QAC5C,IAAI,CAAC,OAAO,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;QAE9E,MAAM,UAAe,kJAAG,CAAC,MAAM,CAAC,OAAO,QAAQ,GAAG,CAAC,UAAU;QAC7D,IAAI,CAAC,QAAQ,IAAI,IAAI,QAAQ,IAAI,CAAC,WAAW,OAAO,SAAS;YAC3D,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAY,GAAG;gBAAE,QAAQ;YAAI;QACjE;QAEA,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEjC,MAAM,yHAAM,CAAC,QAAQ,CAAC,MAAM,CAAC;YAC3B,OAAO;gBAAE;YAAG;YACZ,MAAM;gBAAE,OAAO;YAAM;QACvB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAmB,GAAG;YAAE,QAAQ;QAAI;IACxE;AACF"}}]
}