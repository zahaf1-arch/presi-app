{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///D:/ELECTION/application/pr%C3%A9sidentille/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient }\n\nexport const prisma =\n  globalForPrisma.prisma ||\n  new PrismaClient({\n    log: ['query'],\n  })\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;KAAQ;AAChB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///D:/ELECTION/application/pr%C3%A9sidentille/app/api/users/%5Bid%5D/reset-password/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\r\nimport { prisma } from \"@/lib/prisma\"\r\nimport jwt from \"jsonwebtoken\"\r\nimport bcrypt from \"bcryptjs\"\r\n\r\nexport async function POST(\r\n  request: NextRequest,\r\n  context: { params: Promise<{ id: string }> }\r\n) {\r\n  try {\r\n    const { id } = await context.params\r\n\r\n    const token = request.cookies.get(\"token\")?.value\r\n    if (!token) {\r\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\r\n    }\r\n\r\n    const decoded: any = jwt.verify(token, process.env.JWT_SECRET!)\r\n    if (decoded.role?.toLowerCase() !== \"admin\") {\r\n      return NextResponse.json({ error: \"Forbidden\" }, { status: 403 })\r\n    }\r\n\r\n    // üîê MOT DE PASSE FIXE\r\n    const DEFAULT_PASSWORD = \"123456789\"\r\n\r\n    const hashed = await bcrypt.hash(DEFAULT_PASSWORD, 10)\r\n\r\n    await prisma.user.update({\r\n      where: { id: Number(id) },\r\n      data: {\r\n        password: hashed,\r\n        mustChangePassword: true, // üî• OBLIGATOIRE\r\n      },\r\n    })\r\n\r\n    // ‚ö†Ô∏è renvoy√© UNE SEULE FOIS √† l‚Äôadmin\r\n    return NextResponse.json({ password: DEFAULT_PASSWORD })\r\n  } catch (error) {\r\n    console.error(\"RESET PASSWORD ERROR:\", error)\r\n    return NextResponse.json({ error: \"Server error\" }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,KACpB,OAAoB,EACpB,OAA4C;IAE5C,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM,QAAQ,MAAM;QAEnC,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,UAAU;QAC5C,IAAI,CAAC,OAAO;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpE;QAEA,MAAM,UAAe,kJAAG,CAAC,MAAM,CAAC,OAAO,QAAQ,GAAG,CAAC,UAAU;QAC7D,IAAI,QAAQ,IAAI,EAAE,kBAAkB,SAAS;YAC3C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAY,GAAG;gBAAE,QAAQ;YAAI;QACjE;QAEA,uBAAuB;QACvB,MAAM,mBAAmB;QAEzB,MAAM,SAAS,MAAM,8IAAM,CAAC,IAAI,CAAC,kBAAkB;QAEnD,MAAM,yHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YACvB,OAAO;gBAAE,IAAI,OAAO;YAAI;YACxB,MAAM;gBACJ,UAAU;gBACV,oBAAoB;YACtB;QACF;QAEA,sCAAsC;QACtC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,UAAU;QAAiB;IACxD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;AACF"}}]
}