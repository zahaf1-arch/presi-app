{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///D:/ELECTION/application/pr%C3%A9sidentille/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient }\n\nexport const prisma =\n  globalForPrisma.prisma ||\n  new PrismaClient({\n    log: ['query'],\n  })\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;KAAQ;AAChB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///D:/ELECTION/application/pr%C3%A9sidentille/app/api/users/%5Bid%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\r\nimport { prisma } from \"@/lib/prisma\"\r\nimport jwt from \"jsonwebtoken\"\r\n\r\nexport async function DELETE(\r\n  request: NextRequest,\r\n  context: { params: Promise<{ id: string }> } // ðŸ”¥ PROMISE\r\n) {\r\n  try {\r\n    // âœ… IMPORTANT\r\n    const { id } = await context.params\r\n    const userId = Number(id)\r\n\r\n    if (isNaN(userId)) {\r\n      return NextResponse.json({ error: \"Invalid user id\" }, { status: 400 })\r\n    }\r\n\r\n    const token = request.cookies.get(\"token\")?.value\r\n    if (!token) {\r\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\r\n    }\r\n\r\n    const decoded: any = jwt.verify(token, process.env.JWT_SECRET!)\r\n\r\n    if (decoded.role?.toLowerCase() !== \"admin\") {\r\n      return NextResponse.json({ error: \"Forbidden\" }, { status: 403 })\r\n    }\r\n\r\n    // ðŸ”’ SÃ©curitÃ© : empÃªcher lâ€™admin de se supprimer\r\n    if (decoded.id === userId) {\r\n      return NextResponse.json(\r\n        { error: \"You cannot delete your own account\" },\r\n        { status: 400 }\r\n      )\r\n    }\r\n\r\n    await prisma.user.delete({\r\n      where: { id: userId },\r\n    })\r\n\r\n    return NextResponse.json({ success: true })\r\n  } catch (error) {\r\n    console.error(\"DELETE /api/users/[id] error:\", error)\r\n    return NextResponse.json({ error: \"Server error\" }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,OACpB,OAAoB,EACpB,OAA4C,AAAC,aAAa;;IAE1D,IAAI;QACF,cAAc;QACd,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM,QAAQ,MAAM;QACnC,MAAM,SAAS,OAAO;QAEtB,IAAI,MAAM,SAAS;YACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACvE;QAEA,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,UAAU;QAC5C,IAAI,CAAC,OAAO;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpE;QAEA,MAAM,UAAe,kJAAG,CAAC,MAAM,CAAC,OAAO,QAAQ,GAAG,CAAC,UAAU;QAE7D,IAAI,QAAQ,IAAI,EAAE,kBAAkB,SAAS;YAC3C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAY,GAAG;gBAAE,QAAQ;YAAI;QACjE;QAEA,iDAAiD;QACjD,IAAI,QAAQ,EAAE,KAAK,QAAQ;YACzB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAqC,GAC9C;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,yHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YACvB,OAAO;gBAAE,IAAI;YAAO;QACtB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;AACF"}}]
}