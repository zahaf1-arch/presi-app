{"version":3,"sources":["../../../src/build/webpack-config.ts"],"sourcesContent":["import React from 'react'\nimport ReactRefreshWebpackPlugin from 'next/dist/compiled/@next/react-refresh-utils/dist/ReactRefreshWebpackPlugin'\nimport { yellow, bold } from '../lib/picocolors'\nimport crypto from 'crypto'\nimport { webpack } from 'next/dist/compiled/webpack/webpack'\nimport path from 'path'\n\nimport { getDefineEnv } from './define-env'\nimport { escapeStringRegexp } from '../shared/lib/escape-regexp'\nimport { WEBPACK_LAYERS, WEBPACK_RESOURCE_QUERIES } from '../lib/constants'\nimport type { WebpackLayerName } from '../lib/constants'\nimport {\n  isWebpackBundledLayer,\n  isWebpackClientOnlyLayer,\n  shouldUseReactServerCondition,\n  isWebpackDefaultLayer,\n  RSPACK_DEFAULT_LAYERS_REGEX,\n} from './utils'\nimport type { CustomRoutes } from '../lib/load-custom-routes.js'\nimport {\n  CLIENT_STATIC_FILES_RUNTIME_MAIN,\n  CLIENT_STATIC_FILES_RUNTIME_MAIN_APP,\n  CLIENT_STATIC_FILES_RUNTIME_POLYFILLS_SYMBOL,\n  CLIENT_STATIC_FILES_RUNTIME_REACT_REFRESH,\n  CLIENT_STATIC_FILES_RUNTIME_WEBPACK,\n  MIDDLEWARE_REACT_LOADABLE_MANIFEST,\n  REACT_LOADABLE_MANIFEST,\n  SERVER_DIRECTORY,\n  COMPILER_NAMES,\n} from '../shared/lib/constants'\nimport type { CompilerNameValues } from '../shared/lib/constants'\nimport { execOnce } from '../shared/lib/utils'\nimport type { NextConfigComplete } from '../server/config-shared'\nimport { finalizeEntrypoint } from './entries'\nimport * as Log from './output/log'\nimport { buildConfiguration } from './webpack/config'\nimport ForceCompleteRuntimePlugin from './webpack/plugins/force-complete-runtime'\nimport MiddlewarePlugin, {\n  getEdgePolyfilledModules,\n  handleWebpackExternalForEdgeRuntime,\n} from './webpack/plugins/middleware-plugin'\nimport BuildManifestPlugin from './webpack/plugins/build-manifest-plugin'\nimport { JsConfigPathsPlugin } from './webpack/plugins/jsconfig-paths-plugin'\nimport PagesManifestPlugin from './webpack/plugins/pages-manifest-plugin'\nimport { ProfilingPlugin } from './webpack/plugins/profiling-plugin'\nimport { ReactLoadablePlugin } from './webpack/plugins/react-loadable-plugin'\nimport { WellKnownErrorsPlugin } from './webpack/plugins/wellknown-errors-plugin'\nimport { regexLikeCss } from './webpack/config/blocks/css'\nimport { CopyFilePlugin } from './webpack/plugins/copy-file-plugin'\nimport { ClientReferenceManifestPlugin } from './webpack/plugins/flight-manifest-plugin'\nimport { FlightClientEntryPlugin as NextFlightClientEntryPlugin } from './webpack/plugins/flight-client-entry-plugin'\nimport { RspackFlightClientEntryPlugin } from './webpack/plugins/rspack-flight-client-entry-plugin'\nimport { NextTypesPlugin } from './webpack/plugins/next-types-plugin'\nimport type {\n  Feature,\n  SWC_TARGET_TRIPLE,\n} from './webpack/plugins/telemetry-plugin/telemetry-plugin'\nimport type { Span } from '../trace'\nimport type { ProxyMatcher } from './analysis/get-page-static-info'\nimport loadJsConfig, {\n  type JsConfig,\n  type ResolvedBaseUrl,\n} from './load-jsconfig'\nimport { SubresourceIntegrityPlugin } from './webpack/plugins/subresource-integrity-plugin'\nimport { NextFontManifestPlugin } from './webpack/plugins/next-font-manifest-plugin'\nimport { getSupportedBrowsers } from './utils'\nimport { MemoryWithGcCachePlugin } from './webpack/plugins/memory-with-gc-cache-plugin'\nimport { getBabelConfigFile } from './get-babel-config-file'\nimport { needsExperimentalReact } from '../lib/needs-experimental-react'\nimport type { SWCLoaderOptions } from './webpack/loaders/next-swc-loader'\nimport { isResourceInPackages, makeExternalHandler } from './handle-externals'\nimport { getMainField, edgeConditionName } from './webpack-config-rules/resolve'\nimport { OptionalPeerDependencyResolverPlugin } from './webpack/plugins/optional-peer-dependency-resolve-plugin'\nimport {\n  createWebpackAliases,\n  createServerOnlyClientOnlyAliases,\n  createVendoredReactAliases,\n  createNextApiEsmAliases,\n  createAppRouterApiAliases,\n} from './create-compiler-aliases'\nimport { hasCustomExportOutput } from '../export/utils'\nimport { CssChunkingPlugin } from './webpack/plugins/css-chunking-plugin'\nimport {\n  getBabelLoader,\n  getReactCompilerLoader,\n} from './get-babel-loader-config'\nimport {\n  NEXT_PROJECT_ROOT,\n  NEXT_PROJECT_ROOT_DIST_CLIENT,\n} from './next-dir-paths'\nimport { getRspackCore } from '../shared/lib/get-rspack'\nimport { RspackProfilingPlugin } from './webpack/plugins/rspack-profiling-plugin'\nimport getWebpackBundler from '../shared/lib/get-webpack-bundler'\nimport type { NextBuildContext } from './build-context'\nimport type { RootParamsLoaderOpts } from './webpack/loaders/next-root-params-loader'\nimport type { InvalidImportLoaderOpts } from './webpack/loaders/next-invalid-import-error-loader'\nimport { defaultOverrides } from '../server/require-hook'\n\ntype ExcludesFalse = <T>(x: T | false) => x is T\ntype ClientEntries = {\n  [key: string]: string | string[]\n}\n\nconst EXTERNAL_PACKAGES =\n  require('../lib/server-external-packages.json') as string[]\n\nconst DEFAULT_TRANSPILED_PACKAGES =\n  require('../lib/default-transpiled-packages.json') as string[]\n\nif (parseInt(React.version) < 18) {\n  throw new Error('Next.js requires react >= 18.2.0 to be installed.')\n}\n\nexport const babelIncludeRegexes: RegExp[] = [\n  /next[\\\\/]dist[\\\\/](esm[\\\\/])?shared[\\\\/]lib/,\n  /next[\\\\/]dist[\\\\/](esm[\\\\/])?client/,\n  /next[\\\\/]dist[\\\\/](esm[\\\\/])?pages/,\n  /[\\\\/](strip-ansi|ansi-regex|styled-jsx)[\\\\/]/,\n]\n\nconst browserNonTranspileModules = [\n  // Transpiling `process/browser` will trigger babel compilation error due to value replacement.\n  // TypeError: Property left of AssignmentExpression expected node to be of a type [\"LVal\"] but instead got \"BooleanLiteral\"\n  // e.g. `process.browser = true` will become `true = true`.\n  /[\\\\/]node_modules[\\\\/]process[\\\\/]browser/,\n  // Exclude precompiled react packages from browser compilation due to SWC helper insertion (#61791),\n  // We fixed the issue but it's safer to exclude them from compilation since they don't need to be re-compiled.\n  /[\\\\/]next[\\\\/]dist[\\\\/]compiled[\\\\/](react|react-dom|react-server-dom-webpack)(-experimental)?($|[\\\\/])/,\n]\nconst precompileRegex = /[\\\\/]next[\\\\/]dist[\\\\/]compiled[\\\\/]/\n\nconst asyncStoragesRegex =\n  /next[\\\\/]dist[\\\\/](esm[\\\\/])?server[\\\\/]app-render[\\\\/](work-async-storage|action-async-storage|dynamic-access-async-storage|work-unit-async-storage)/\n\n// Support for NODE_PATH\nconst nodePathList = (process.env.NODE_PATH || '')\n  .split(process.platform === 'win32' ? ';' : ':')\n  .filter((p) => !!p)\n\nconst baseWatchOptions: webpack.Configuration['watchOptions'] = Object.freeze({\n  aggregateTimeout: 5,\n  ignored:\n    // Matches **/node_modules/**, **/.git/** and **/.next/**\n    /^((?:[^/]*(?:\\/|$))*)(\\.(git|next)|node_modules)(\\/((?:[^/]*(?:\\/|$))*)(?:$|\\/))?/,\n})\n\nfunction isModuleCSS(module: { type: string }) {\n  return (\n    // mini-css-extract-plugin\n    module.type === `css/mini-extract` ||\n    // extract-css-chunks-webpack-plugin (old)\n    module.type === `css/extract-chunks` ||\n    // extract-css-chunks-webpack-plugin (new)\n    module.type === `css/extract-css-chunks`\n  )\n}\n\nconst devtoolRevertWarning = execOnce(\n  (devtool: webpack.Configuration['devtool']) => {\n    console.warn(\n      yellow(bold('Warning: ')) +\n        bold(`Reverting webpack devtool to '${devtool}'.\\n`) +\n        'Changing the webpack devtool in development mode will cause severe performance regressions.\\n' +\n        'Read more: https://nextjs.org/docs/messages/improper-devtool'\n    )\n  }\n)\n\nlet loggedSwcDisabled = false\nlet loggedIgnoredCompilerOptions = false\nconst reactRefreshLoaderName =\n  'next/dist/compiled/@next/react-refresh-utils/dist/loader'\n\nfunction getReactRefreshLoader() {\n  return process.env.NEXT_RSPACK\n    ? 'builtin:react-refresh-loader'\n    : require.resolve(reactRefreshLoaderName)\n}\n\nexport function attachReactRefresh(\n  webpackConfig: webpack.Configuration,\n  targetLoader: webpack.RuleSetUseItem\n) {\n  const reactRefreshLoader = getReactRefreshLoader()\n  webpackConfig.module?.rules?.forEach((rule) => {\n    if (rule && typeof rule === 'object' && 'use' in rule) {\n      const curr = rule.use\n      // When the user has configured `defaultLoaders.babel` for a input file:\n      if (curr === targetLoader) {\n        rule.use = [reactRefreshLoader, curr as webpack.RuleSetUseItem]\n      } else if (\n        Array.isArray(curr) &&\n        curr.some((r) => r === targetLoader) &&\n        // Check if loader already exists:\n        !curr.some(\n          (r) => r === reactRefreshLoader || r === reactRefreshLoaderName\n        )\n      ) {\n        const idx = curr.findIndex((r) => r === targetLoader)\n        // Clone to not mutate user input\n        rule.use = [...curr]\n\n        // inject / input: [other, babel] output: [other, refresh, babel]:\n        rule.use.splice(idx, 0, reactRefreshLoader)\n      }\n    }\n  })\n}\n\nexport const NODE_RESOLVE_OPTIONS = {\n  dependencyType: 'commonjs',\n  modules: ['node_modules'],\n  fallback: false,\n  exportsFields: ['exports'],\n  importsFields: ['imports'],\n  conditionNames: ['node', 'require'],\n  descriptionFiles: ['package.json'],\n  extensions: ['.js', '.json', '.node'],\n  enforceExtensions: false,\n  symlinks: true,\n  mainFields: ['main'],\n  mainFiles: ['index'],\n  roots: [],\n  fullySpecified: false,\n  preferRelative: false,\n  preferAbsolute: false,\n  restrictions: [],\n}\n\nexport const NODE_BASE_RESOLVE_OPTIONS = {\n  ...NODE_RESOLVE_OPTIONS,\n  alias: false,\n}\n\nexport const NODE_ESM_RESOLVE_OPTIONS = {\n  ...NODE_RESOLVE_OPTIONS,\n  alias: false,\n  dependencyType: 'esm',\n  conditionNames: ['node', 'import'],\n  fullySpecified: true,\n}\n\nexport const NODE_BASE_ESM_RESOLVE_OPTIONS = {\n  ...NODE_ESM_RESOLVE_OPTIONS,\n  alias: false,\n}\n\nexport const nextImageLoaderRegex =\n  /\\.(png|jpg|jpeg|gif|webp|avif|ico|bmp|svg)$/i\n\nexport async function loadProjectInfo({\n  dir,\n  config,\n  dev,\n}: {\n  dir: string\n  config: NextConfigComplete\n  dev: boolean\n}): Promise<{\n  jsConfig: JsConfig\n  jsConfigPath?: string\n  resolvedBaseUrl: ResolvedBaseUrl\n  supportedBrowsers: string[] | undefined\n}> {\n  const { jsConfig, jsConfigPath, resolvedBaseUrl } = await loadJsConfig(\n    dir,\n    config\n  )\n  const supportedBrowsers = getSupportedBrowsers(dir, dev)\n  return {\n    jsConfig,\n    jsConfigPath,\n    resolvedBaseUrl,\n    supportedBrowsers,\n  }\n}\n\nexport function hasExternalOtelApiPackage(): boolean {\n  try {\n    require('@opentelemetry/api') as typeof import('@opentelemetry/api')\n    return true\n  } catch {\n    return false\n  }\n}\n\nconst UNSAFE_CACHE_REGEX = /[\\\\/]pages[\\\\/][^\\\\/]+(?:$|\\?|#)/\n\nconst NEGATIVE_UNSAFE_CACHE_REGEX = new RegExp(\n  `^(?!.*${UNSAFE_CACHE_REGEX.source}).*$`\n)\n\nexport function getCacheDirectories(\n  configs: webpack.Configuration[]\n): Set<string> {\n  return new Set(\n    configs\n      .map((cfg) => {\n        if (typeof cfg.cache === 'object' && cfg.cache.type === 'filesystem') {\n          return cfg.cache.cacheDirectory\n        }\n        return null\n      })\n      .filter((dir) => dir != null)\n  )\n}\n\nexport default async function getBaseWebpackConfig(\n  dir: string,\n  {\n    buildId,\n    encryptionKey,\n    config,\n    compilerType,\n    dev = false,\n    entrypoints,\n    isDevFallback = false,\n    pagesDir,\n    reactProductionProfiling = false,\n    rewrites,\n    originalRewrites,\n    originalRedirects,\n    runWebpackSpan,\n    appDir,\n    middlewareMatchers,\n    noMangling,\n    jsConfig,\n    jsConfigPath,\n    resolvedBaseUrl,\n    supportedBrowsers,\n    clientRouterFilters,\n    fetchCacheKeyPrefix,\n    isCompileMode,\n    previewProps,\n  }: {\n    previewProps: NonNullable<(typeof NextBuildContext)['previewProps']>\n    isCompileMode?: boolean\n    buildId: string\n    encryptionKey: string\n    config: NextConfigComplete\n    compilerType: CompilerNameValues\n    dev?: boolean\n    entrypoints: webpack.EntryObject\n    isDevFallback?: boolean\n    pagesDir: string | undefined\n    reactProductionProfiling?: boolean\n    rewrites: CustomRoutes['rewrites']\n    originalRewrites: CustomRoutes['rewrites'] | undefined\n    originalRedirects: CustomRoutes['redirects'] | undefined\n    runWebpackSpan: Span\n    appDir: string | undefined\n    middlewareMatchers?: ProxyMatcher[]\n    noMangling?: boolean\n    jsConfig: any\n    jsConfigPath?: string\n    resolvedBaseUrl: ResolvedBaseUrl\n    supportedBrowsers: string[] | undefined\n    clientRouterFilters?: {\n      staticFilter: ReturnType<\n        import('../shared/lib/bloom-filter').BloomFilter['export']\n      >\n      dynamicFilter: ReturnType<\n        import('../shared/lib/bloom-filter').BloomFilter['export']\n      >\n    }\n    fetchCacheKeyPrefix?: string\n  }\n): Promise<webpack.Configuration> {\n  const bundler = getWebpackBundler()\n  const isClient = compilerType === COMPILER_NAMES.client\n  const isEdgeServer = compilerType === COMPILER_NAMES.edgeServer\n  const isNodeServer = compilerType === COMPILER_NAMES.server\n\n  const isRspack = Boolean(process.env.NEXT_RSPACK)\n\n  const FlightClientEntryPlugin =\n    isRspack && process.env.BUILTIN_FLIGHT_CLIENT_ENTRY_PLUGIN\n      ? RspackFlightClientEntryPlugin\n      : NextFlightClientEntryPlugin\n\n  // If the current compilation is aimed at server-side code instead of client-side code.\n  const isNodeOrEdgeCompilation = isNodeServer || isEdgeServer\n\n  const hasRewrites =\n    rewrites.beforeFiles.length > 0 ||\n    rewrites.afterFiles.length > 0 ||\n    rewrites.fallback.length > 0\n\n  const hasAppDir = !!appDir\n  const disableOptimizedLoading = true\n  const bundledReactChannel = needsExperimentalReact(config)\n    ? '-experimental'\n    : ''\n\n  const babelConfigFile = getBabelConfigFile(dir)\n\n  if (!dev && hasCustomExportOutput(config)) {\n    config.distDir = '.next'\n  }\n  const distDir = path.join(dir, config.distDir)\n\n  let useSWCLoader = !babelConfigFile || config.experimental.forceSwcTransforms\n  let SWCBinaryTarget: [Feature, boolean] | undefined = undefined\n  if (useSWCLoader) {\n    // TODO: we do not collect wasm target yet\n    const binaryTarget = (\n      require('./swc') as typeof import('./swc')\n    )?.getBinaryMetadata?.()?.target as SWC_TARGET_TRIPLE\n    SWCBinaryTarget = binaryTarget\n      ? [`swc/target/${binaryTarget}` as const, true]\n      : undefined\n  }\n\n  if (!loggedSwcDisabled && !useSWCLoader && babelConfigFile) {\n    Log.info(\n      `Disabled SWC as replacement for Babel because of custom Babel configuration \"${path.relative(\n        dir,\n        babelConfigFile\n      )}\" https://nextjs.org/docs/messages/swc-disabled`\n    )\n    loggedSwcDisabled = true\n  }\n\n  // since `pages` doesn't always bundle by default we need to\n  // auto-include optimizePackageImports in transpilePackages\n  const finalTranspilePackages: string[] = (\n    config.transpilePackages || []\n  ).concat(DEFAULT_TRANSPILED_PACKAGES)\n\n  for (const pkg of config.experimental.optimizePackageImports || []) {\n    if (!finalTranspilePackages.includes(pkg)) {\n      finalTranspilePackages.push(pkg)\n    }\n  }\n\n  if (!loggedIgnoredCompilerOptions && !useSWCLoader && config.compiler) {\n    Log.info(\n      '`compiler` options in `next.config.js` will be ignored while using Babel https://nextjs.org/docs/messages/ignored-compiler-options'\n    )\n    loggedIgnoredCompilerOptions = true\n  }\n\n  const excludeCache: Record<string, boolean> = {}\n  function exclude(excludePath: string): boolean {\n    const cached = excludeCache[excludePath]\n    if (cached !== undefined) {\n      return cached\n    }\n\n    const shouldExclude =\n      excludePath.includes('node_modules') &&\n      !babelIncludeRegexes.some((r) => r.test(excludePath)) &&\n      !isResourceInPackages(excludePath, finalTranspilePackages)\n\n    excludeCache[excludePath] = shouldExclude\n    return shouldExclude\n  }\n\n  const shouldIncludeExternalDirs =\n    config.experimental.externalDir || !!config.transpilePackages\n  const codeCondition = {\n    test: { or: [/\\.(tsx|ts|js|cjs|mjs|jsx)$/, /__barrel_optimize__/] },\n    ...(shouldIncludeExternalDirs\n      ? // Allowing importing TS/TSX files from outside of the root dir.\n        {}\n      : { include: [dir, ...babelIncludeRegexes] }),\n    exclude,\n  }\n\n  const babelLoader = getBabelLoader(\n    useSWCLoader,\n    babelConfigFile,\n    isNodeOrEdgeCompilation,\n    distDir,\n    pagesDir,\n    dir,\n    (appDir || pagesDir)!,\n    dev,\n    isClient,\n    config.reactCompiler,\n    codeCondition.exclude\n  )\n\n  const reactCompilerLoader = babelLoader\n    ? undefined\n    : getReactCompilerLoader(\n        config.reactCompiler,\n        dir,\n        isNodeOrEdgeCompilation,\n        codeCondition.exclude,\n        dev\n      )\n\n  let swcTraceProfilingInitialized = false\n  const getSwcLoader = (extraOptions: Partial<SWCLoaderOptions>) => {\n    if (\n      config?.experimental?.swcTraceProfiling &&\n      !swcTraceProfilingInitialized\n    ) {\n      // This will init subscribers once only in a single process lifecycle,\n      // even though it can be called multiple times.\n      // Subscriber need to be initialized _before_ any actual swc's call (transform, etcs)\n      // to collect correct trace spans when they are called.\n      swcTraceProfilingInitialized = true\n      ;(\n        require('./swc') as typeof import('./swc')\n      )?.initCustomTraceSubscriber?.(\n        path.join(distDir, `swc-trace-profile-${Date.now()}.json`)\n      )\n    }\n\n    const useBuiltinSwcLoader = process.env.BUILTIN_SWC_LOADER\n    if (isRspack && useBuiltinSwcLoader) {\n      return {\n        loader: 'builtin:next-swc-loader',\n        options: {\n          isServer: isNodeOrEdgeCompilation,\n          rootDir: dir,\n          pagesDir,\n          appDir,\n          hasReactRefresh: dev && isClient,\n          transpilePackages: finalTranspilePackages,\n          supportedBrowsers,\n          swcCacheDir: path.join(\n            dir,\n            config?.distDir ?? '.next',\n            'cache',\n            'swc'\n          ),\n          serverReferenceHashSalt: encryptionKey,\n\n          // rspack specific options\n          pnp: Boolean(process.versions.pnp),\n          optimizeServerReact: Boolean(config.experimental.optimizeServerReact),\n          modularizeImports: config.modularizeImports,\n          decorators: Boolean(\n            jsConfig?.compilerOptions?.experimentalDecorators\n          ),\n          emitDecoratorMetadata: Boolean(\n            jsConfig?.compilerOptions?.emitDecoratorMetadata\n          ),\n          regeneratorRuntimePath: require.resolve(\n            'next/dist/compiled/regenerator-runtime'\n          ),\n\n          ...extraOptions,\n        },\n      }\n    }\n\n    return {\n      loader: 'next-swc-loader',\n      options: {\n        isServer: isNodeOrEdgeCompilation,\n        compilerType,\n        rootDir: dir,\n        pagesDir,\n        appDir,\n        hasReactRefresh: dev && isClient,\n        nextConfig: config,\n        jsConfig,\n        transpilePackages: finalTranspilePackages,\n        supportedBrowsers,\n        swcCacheDir: path.join(dir, config?.distDir ?? '.next', 'cache', 'swc'),\n        serverReferenceHashSalt: encryptionKey,\n        ...extraOptions,\n      } satisfies SWCLoaderOptions,\n    }\n  }\n\n  // RSC loaders, prefer ESM, set `esm` to true\n  const swcServerLayerLoader = getSwcLoader({\n    serverComponents: true,\n    bundleLayer: WEBPACK_LAYERS.reactServerComponents,\n    esm: true,\n  })\n  const swcSSRLayerLoader = getSwcLoader({\n    serverComponents: true,\n    bundleLayer: WEBPACK_LAYERS.serverSideRendering,\n    esm: true,\n  })\n  const swcBrowserLayerLoader = getSwcLoader({\n    serverComponents: true,\n    bundleLayer: WEBPACK_LAYERS.appPagesBrowser,\n    esm: true,\n  })\n  // Default swc loaders for pages doesn't prefer ESM.\n  const swcDefaultLoader = getSwcLoader({\n    serverComponents: true,\n    esm: false,\n  })\n\n  const defaultLoaders = {\n    babel: useSWCLoader ? swcDefaultLoader : babelLoader!,\n  }\n\n  const appServerLayerLoaders = hasAppDir\n    ? [\n        // When using Babel, we will have to add the SWC loader\n        // as an additional pass to handle RSC correctly.\n        // This will cause some performance overhead but\n        // acceptable as Babel will not be recommended.\n        swcServerLayerLoader,\n        babelLoader,\n        reactCompilerLoader,\n      ].filter(Boolean)\n    : []\n\n  const instrumentLayerLoaders = [\n    'next-flight-loader',\n    // When using Babel, we will have to add the SWC loader\n    // as an additional pass to handle RSC correctly.\n    // This will cause some performance overhead but\n    // acceptable as Babel will not be recommended.\n    swcServerLayerLoader,\n    babelLoader,\n  ].filter(Boolean)\n\n  const middlewareLayerLoaders = [\n    'next-flight-loader',\n    // When using Babel, we will have to use SWC to do the optimization\n    // for middleware to tree shake the unused default optimized imports like \"next/server\".\n    // This will cause some performance overhead but\n    // acceptable as Babel will not be recommended.\n    getSwcLoader({\n      serverComponents: true,\n      bundleLayer: WEBPACK_LAYERS.middleware,\n    }),\n    babelLoader,\n  ].filter(Boolean)\n\n  const reactRefreshLoaders = dev && isClient ? [getReactRefreshLoader()] : []\n\n  // client components layers: SSR or browser\n  const createClientLayerLoader = ({\n    isBrowserLayer,\n    reactRefresh,\n  }: {\n    isBrowserLayer: boolean\n    reactRefresh: boolean\n  }) => [\n    ...(reactRefresh ? reactRefreshLoaders : []),\n    {\n      // This loader handles actions and client entries\n      // in the client layer.\n      loader: 'next-flight-client-module-loader',\n    },\n    ...(hasAppDir\n      ? [\n          // When using Babel, we will have to add the SWC loader\n          // as an additional pass to handle RSC correctly.\n          // This will cause some performance overhead but\n          // acceptable as Babel will not be recommended.\n          isBrowserLayer ? swcBrowserLayerLoader : swcSSRLayerLoader,\n          babelLoader,\n          reactCompilerLoader,\n        ].filter(Boolean)\n      : []),\n  ]\n\n  const appBrowserLayerLoaders = createClientLayerLoader({\n    isBrowserLayer: true,\n    // reactRefresh for browser layer is applied conditionally to user-land source\n    reactRefresh: false,\n  })\n  const appSSRLayerLoaders = createClientLayerLoader({\n    isBrowserLayer: false,\n    reactRefresh: true,\n  })\n\n  // Loader for API routes needs to be differently configured as it shouldn't\n  // have RSC transpiler enabled, so syntax checks such as invalid imports won't\n  // be performed.\n  const apiRoutesLayerLoaders = useSWCLoader\n    ? getSwcLoader({\n        serverComponents: false,\n        bundleLayer: WEBPACK_LAYERS.apiNode,\n      })\n    : defaultLoaders.babel\n\n  const pageExtensions = config.pageExtensions\n\n  const outputPath = isNodeOrEdgeCompilation\n    ? path.join(distDir, SERVER_DIRECTORY)\n    : distDir\n\n  const conditionNames = [\n    ...(isEdgeServer ? [edgeConditionName] : []),\n    // inherits Webpack's default conditions\n    '...',\n  ]\n  const reactServerConditionNames = [\n    'react-server',\n    // We could just use `'...'`. Explicit spread makes it more obvious.\n    ...conditionNames,\n  ]\n\n  const reactRefreshEntry = isRspack\n    ? require.resolve(\n        `next/dist/compiled/@next/react-refresh-utils/dist/rspack-runtime`\n      )\n    : require.resolve(\n        `next/dist/compiled/@next/react-refresh-utils/dist/runtime`\n      )\n\n  const clientEntries = isClient\n    ? ({\n        // Backwards compatibility\n        'main.js': [],\n        ...(dev\n          ? {\n              [CLIENT_STATIC_FILES_RUNTIME_REACT_REFRESH]: reactRefreshEntry,\n            }\n          : {}),\n        [CLIENT_STATIC_FILES_RUNTIME_MAIN]:\n          `./` +\n          path\n            .relative(\n              dir,\n              path.join(\n                NEXT_PROJECT_ROOT_DIST_CLIENT,\n                dev ? `next-dev.js` : 'next.js'\n              )\n            )\n            .replace(/\\\\/g, '/'),\n        ...(hasAppDir\n          ? {\n              [CLIENT_STATIC_FILES_RUNTIME_MAIN_APP]: dev\n                ? [\n                    reactRefreshEntry,\n                    `./` +\n                      path\n                        .relative(\n                          dir,\n                          path.join(\n                            NEXT_PROJECT_ROOT_DIST_CLIENT,\n                            'app-next-dev.js'\n                          )\n                        )\n                        .replace(/\\\\/g, '/'),\n                  ]\n                : [\n                    `./` +\n                      path\n                        .relative(\n                          dir,\n                          path.join(\n                            NEXT_PROJECT_ROOT_DIST_CLIENT,\n                            'app-next.js'\n                          )\n                        )\n                        .replace(/\\\\/g, '/'),\n                  ],\n            }\n          : {}),\n      } satisfies ClientEntries)\n    : undefined\n\n  const resolveConfig: webpack.Configuration['resolve'] = {\n    conditionNames,\n    // Disable .mjs for node_modules bundling\n    extensions: ['.js', '.mjs', '.tsx', '.ts', '.jsx', '.json', '.wasm'],\n    extensionAlias: config.experimental.extensionAlias,\n    modules: [\n      'node_modules',\n      ...nodePathList, // Support for NODE_PATH environment variable\n    ],\n    alias: createWebpackAliases({\n      distDir,\n      isClient,\n      isEdgeServer,\n      dev,\n      config,\n      pagesDir,\n      appDir,\n      dir,\n      reactProductionProfiling,\n    }),\n    ...(isClient\n      ? {\n          fallback: {\n            process: require.resolve('./polyfills/process'),\n          },\n        }\n      : undefined),\n    // default main fields use pages dir ones, and customize app router ones in loaders.\n    mainFields: getMainField(compilerType, false),\n    plugins: [\n      isNodeServer ? new OptionalPeerDependencyResolverPlugin() : undefined,\n    ].filter(Boolean) as webpack.ResolvePluginInstance[],\n    ...((isRspack && jsConfigPath\n      ? {\n          // Skip paths that are routed to a .d.ts file\n          restrictions: [/^(?!.*\\.d\\.ts$).*$/],\n          tsConfig: {\n            configFile: jsConfigPath,\n          },\n        }\n      : {}) as any),\n  }\n\n  // Packages which will be split into the 'framework' chunk.\n  // Only top-level packages are included, e.g. nested copies like\n  // 'node_modules/meow/node_modules/object-assign' are not included.\n  const nextFrameworkPaths: string[] = []\n  const topLevelFrameworkPaths: string[] = []\n  const visitedFrameworkPackages = new Set<string>()\n  // Adds package-paths of dependencies recursively\n  const addPackagePath = (\n    packageName: string,\n    relativeToPath: string,\n    paths: string[]\n  ) => {\n    try {\n      if (visitedFrameworkPackages.has(packageName)) {\n        return\n      }\n      visitedFrameworkPackages.add(packageName)\n\n      const packageJsonPath = require.resolve(`${packageName}/package.json`, {\n        paths: [relativeToPath],\n      })\n\n      // Include a trailing slash so that a `.startsWith(packagePath)` check avoids false positives\n      // when one package name starts with the full name of a different package.\n      // For example:\n      //   \"node_modules/react-slider\".startsWith(\"node_modules/react\")  // true\n      //   \"node_modules/react-slider\".startsWith(\"node_modules/react/\") // false\n      const directory = path.join(packageJsonPath, '../')\n\n      // Returning from the function in case the directory has already been added and traversed\n      if (paths.includes(directory)) return\n      paths.push(directory)\n      const dependencies = require(packageJsonPath).dependencies || {}\n      for (const name of Object.keys(dependencies)) {\n        addPackagePath(name, directory, paths)\n      }\n    } catch (_) {\n      // don't error on failing to resolve framework packages\n    }\n  }\n\n  for (const packageName of [\n    'react',\n    'react-dom',\n    ...(hasAppDir\n      ? [\n          `next/dist/compiled/react${bundledReactChannel}`,\n          `next/dist/compiled/react-dom${bundledReactChannel}`,\n        ]\n      : []),\n  ]) {\n    addPackagePath(packageName, dir, topLevelFrameworkPaths)\n  }\n  addPackagePath('next', dir, nextFrameworkPaths)\n\n  const crossOrigin = config.crossOrigin\n\n  // The `serverExternalPackages` should not conflict with\n  // the `transpilePackages`.\n  if (config.serverExternalPackages && finalTranspilePackages) {\n    const externalPackageConflicts = finalTranspilePackages.filter((pkg) =>\n      config.serverExternalPackages?.includes(pkg)\n    )\n    if (externalPackageConflicts.length > 0) {\n      throw new Error(\n        `The packages specified in the 'transpilePackages' conflict with the 'serverExternalPackages': ${externalPackageConflicts.join(\n          ', '\n        )}`\n      )\n    }\n  }\n\n  // For original request, such as `package name`\n  const optOutBundlingPackages = EXTERNAL_PACKAGES.concat(\n    ...(config.serverExternalPackages || [])\n  ).filter((pkg) => !finalTranspilePackages?.includes(pkg))\n  // For resolved request, such as `absolute path/package name/foo/bar.js`\n  const optOutBundlingPackageRegex = new RegExp(\n    `[/\\\\\\\\]node_modules[/\\\\\\\\](${optOutBundlingPackages\n      .map((p) => p.replace(/\\//g, '[/\\\\\\\\]'))\n      .join('|')})[/\\\\\\\\]`\n  )\n\n  const transpilePackagesRegex = new RegExp(\n    `[/\\\\\\\\]node_modules[/\\\\\\\\](${finalTranspilePackages\n      ?.map((p) => p.replace(/\\//g, '[/\\\\\\\\]'))\n      .join('|')})[/\\\\\\\\]`\n  )\n\n  const handleExternals = makeExternalHandler({\n    config,\n    optOutBundlingPackageRegex,\n    transpiledPackages: finalTranspilePackages,\n    dir,\n  })\n\n  const pageExtensionsRegex = new RegExp(`\\\\.(${pageExtensions.join('|')})$`)\n\n  const aliasCodeConditionTest = [codeCondition.test, pageExtensionsRegex]\n\n  const builtinModules = (require('module') as typeof import('module'))\n    .builtinModules\n\n  const bunExternals = [\n    'bun:ffi',\n    'bun:jsc',\n    'bun:sqlite',\n    'bun:test',\n    'bun:wrap',\n    'bun',\n  ]\n\n  const shouldEnableSlowModuleDetection =\n    !!config.experimental.slowModuleDetection && dev\n\n  const getParallelism = () => {\n    const override = Number(process.env.NEXT_WEBPACK_PARALLELISM)\n    if (shouldEnableSlowModuleDetection) {\n      if (override) {\n        console.warn(\n          'NEXT_WEBPACK_PARALLELISM is specified but will be ignored due to experimental.slowModuleDetection being enabled.'\n        )\n      }\n      return 1\n    }\n    return override || undefined\n  }\n\n  const telemetryPlugin =\n    !dev &&\n    isClient &&\n    new (\n      require('./webpack/plugins/telemetry-plugin/telemetry-plugin') as typeof import('./webpack/plugins/telemetry-plugin/telemetry-plugin')\n    ).TelemetryPlugin(\n      new Map(\n        [\n          ['swcLoader', useSWCLoader],\n          ['swcRelay', !!config.compiler?.relay],\n          ['swcStyledComponents', !!config.compiler?.styledComponents],\n          [\n            'swcReactRemoveProperties',\n            !!config.compiler?.reactRemoveProperties,\n          ],\n          [\n            'swcExperimentalDecorators',\n            !!jsConfig?.compilerOptions?.experimentalDecorators,\n          ],\n          ['swcRemoveConsole', !!config.compiler?.removeConsole],\n          ['swcImportSource', !!jsConfig?.compilerOptions?.jsxImportSource],\n          ['swcEmotion', !!config.compiler?.emotion],\n          ['transpilePackages', !!config.transpilePackages],\n          ['skipProxyUrlNormalize', !!config.skipProxyUrlNormalize],\n          ['skipTrailingSlashRedirect', !!config.skipTrailingSlashRedirect],\n          ['modularizeImports', !!config.modularizeImports],\n          // If esmExternals is not same as default value, it represents customized usage\n          ['esmExternals', config.experimental.esmExternals !== true],\n          SWCBinaryTarget,\n        ].filter<[Feature, boolean]>(Boolean as any)\n      )\n    )\n\n  let webpackConfig: webpack.Configuration = {\n    parallelism: getParallelism(),\n    ...(isNodeServer ? { externalsPresets: { node: true } } : {}),\n    // @ts-ignore\n    externals:\n      !isRspack &&\n      (isClient || isEdgeServer\n        ? // make sure importing \"next\" is handled gracefully for client\n          // bundles in case a user imported types and it wasn't removed\n          // TODO: should we warn/error for this instead?\n          [\n            'next',\n            ...(isEdgeServer\n              ? [\n                  {\n                    '@builder.io/partytown': '{}',\n                    'next/dist/compiled/etag': '{}',\n                  },\n                  getEdgePolyfilledModules(),\n                  handleWebpackExternalForEdgeRuntime,\n                ]\n              : []),\n          ]\n        : [\n            ...builtinModules,\n            ...bunExternals,\n            ({\n              context,\n              request,\n              dependencyType,\n              contextInfo,\n              getResolve,\n            }: {\n              context: string\n              request: string\n              dependencyType: string\n              contextInfo: {\n                issuer: string\n                issuerLayer: string | null\n                compiler: string\n              }\n              getResolve: (\n                options: any\n              ) => (\n                resolveContext: string,\n                resolveRequest: string,\n                callback: (\n                  err?: Error,\n                  result?: string,\n                  resolveData?: { descriptionFileData?: { type?: any } }\n                ) => void\n              ) => void\n            }) =>\n              handleExternals(\n                context,\n                request,\n                dependencyType,\n                contextInfo.issuerLayer as WebpackLayerName,\n                (options) => {\n                  const resolveFunction = getResolve(options)\n                  return (resolveContext: string, requestToResolve: string) =>\n                    new Promise((resolve, reject) => {\n                      resolveFunction(\n                        resolveContext,\n                        requestToResolve,\n                        (err, result, resolveData) => {\n                          if (err) return reject(err)\n                          if (!result) return resolve([null, false])\n                          const isEsm = /\\.js$/i.test(result)\n                            ? resolveData?.descriptionFileData?.type ===\n                              'module'\n                            : /\\.mjs$/i.test(result)\n                          resolve([result, isEsm])\n                        }\n                      )\n                    })\n                }\n              ),\n          ]),\n\n    optimization: {\n      emitOnErrors: !dev,\n      checkWasmTypes: false,\n      nodeEnv: false,\n\n      splitChunks: (():\n        | Required<webpack.Configuration>['optimization']['splitChunks']\n        | false => {\n        // server chunking\n        if (dev) {\n          if (isNodeServer) {\n            /*\n              In development, we want to split code that comes from `node_modules` into their own chunks.\n              This is because in development, we often need to reload the user bundle due to changes in the code.\n              To work around this, we put all the vendor code into separate chunks so that we don't need to reload them.\n              This is safe because the vendor code doesn't change between reloads.\n            */\n            const extractRootNodeModule = (modulePath: string) => {\n              // This regex is used to extract the root node module name to be used as the chunk group name.\n              // example: ../../node_modules/.pnpm/next@10/foo/node_modules/bar -> next@10\n              const regex =\n                /node_modules(?:\\/|\\\\)\\.?(?:pnpm(?:\\/|\\\\))?([^/\\\\]+)/\n              const match = modulePath.match(regex)\n              return match ? match[1] : null\n            }\n            return {\n              cacheGroups: {\n                // this chunk configuration gives us a separate chunk for each top level module in node_modules\n                // or a hashed chunk if we can't extract the module name.\n                vendor: {\n                  chunks: 'all',\n                  reuseExistingChunk: true,\n                  test: /[\\\\/]node_modules[\\\\/]/,\n                  minSize: 0,\n                  minChunks: 1,\n                  maxAsyncRequests: 300,\n                  maxInitialRequests: 300,\n                  name: (module: webpack.Module) => {\n                    const moduleId = module.nameForCondition()!\n                    const rootModule = extractRootNodeModule(moduleId)\n                    if (rootModule) {\n                      return `vendor-chunks/${rootModule}`\n                    } else {\n                      const hash = crypto.createHash('sha1').update(moduleId)\n                      hash.update(moduleId)\n                      return `vendor-chunks/${hash.digest('hex')}`\n                    }\n                  },\n                },\n                // disable the default chunk groups\n                default: false,\n                defaultVendors: false,\n              },\n            }\n          }\n\n          return false\n        }\n\n        if (isNodeServer || isEdgeServer) {\n          return {\n            filename: `${isEdgeServer ? `edge-chunks/` : ''}[name].js`,\n            chunks: 'all',\n            minChunks: 2,\n          }\n        }\n\n        const frameworkCacheGroup = {\n          chunks: 'all' as const,\n          name: 'framework',\n          // Ensures the framework chunk is not created for App Router.\n          layer: isWebpackDefaultLayer,\n          test(module: any) {\n            const resource = module.nameForCondition?.()\n            return resource\n              ? topLevelFrameworkPaths.some((pkgPath) =>\n                  resource.startsWith(pkgPath)\n                )\n              : false\n          },\n          priority: 40,\n          // Don't let webpack eliminate this chunk (prevents this chunk from\n          // becoming a part of the commons chunk)\n          enforce: true,\n        }\n\n        const libCacheGroup = {\n          test(module: {\n            type: string\n            size: Function\n            nameForCondition: Function\n          }): boolean {\n            return (\n              !module.type?.startsWith('css') &&\n              module.size() > 160000 &&\n              /node_modules[/\\\\]/.test(module.nameForCondition() || '')\n            )\n          },\n          name(module: {\n            layer: string | null | undefined\n            type: string\n            libIdent?: Function\n            updateHash: (hash: crypto.Hash) => void\n          }): string {\n            const hash = crypto.createHash('sha1')\n            if (isModuleCSS(module)) {\n              module.updateHash(hash)\n            } else {\n              if (!module.libIdent) {\n                throw new Error(\n                  `Encountered unknown module type: ${module.type}. Please open an issue.`\n                )\n              }\n              hash.update(module.libIdent({ context: dir }))\n            }\n\n            // Ensures the name of the chunk is not the same between two modules in different layers\n            // E.g. if you import 'button-library' in App Router and Pages Router we don't want these to be bundled in the same chunk\n            // as they're never used on the same page.\n            if (module.layer) {\n              hash.update(module.layer)\n            }\n\n            return hash.digest('hex').substring(0, 8)\n          },\n          priority: 30,\n          minChunks: 1,\n          reuseExistingChunk: true,\n        }\n\n        // client chunking\n        return {\n          // Keep main and _app chunks unsplitted in webpack 5\n          // as we don't need a separate vendor chunk from that\n          // and all other chunk depend on them so there is no\n          // duplication that need to be pulled out.\n          chunks: isRspack\n            ? // using a function here causes noticable slowdown\n              // in rspack\n              /^(?!(polyfills|main|pages\\/_app)$).*$/\n            : (chunk: any) =>\n                !/^(polyfills|main|pages\\/_app)$/.test(chunk.name),\n\n          cacheGroups: isRspack\n            ? {\n                framework: {\n                  chunks: 'all' as const,\n                  name: 'framework',\n                  layer: RSPACK_DEFAULT_LAYERS_REGEX,\n                  test: new RegExp(\n                    `^(${topLevelFrameworkPaths.map((p) => `(${escapeStringRegexp(p)})`).join('|')})`\n                  ),\n                  priority: 40,\n                  enforce: true,\n                },\n                lib: {\n                  test: /[/]node_modules[/](?!.*\\.(css|scss|sass|less|styl)$)/,\n                  name: 'lib',\n                  chunks: 'all',\n                  priority: 30,\n                  minChunks: 1,\n                  reuseExistingChunk: true,\n                },\n              }\n            : {\n                framework: frameworkCacheGroup,\n                lib: libCacheGroup,\n              },\n          maxInitialRequests: 25,\n          minSize: 20000,\n        }\n      })(),\n      runtimeChunk: isClient\n        ? { name: CLIENT_STATIC_FILES_RUNTIME_WEBPACK }\n        : undefined,\n\n      minimize:\n        !dev &&\n        (isClient ||\n          isEdgeServer ||\n          (isNodeServer && config.experimental.serverMinification)),\n      minimizer: [\n        // Minify JavaScript\n        isRspack\n          ? new (getRspackCore().SwcJsMinimizerRspackPlugin)({\n              // JS minimizer configuration\n              // options should align with crates/napi/src/minify.rs#patch_opts\n              minimizerOptions: {\n                compress: {\n                  inline: 2,\n                  global_defs: {\n                    'process.env.__NEXT_PRIVATE_MINIMIZE_MACRO_FALSE': false,\n                  },\n                },\n                mangle: !noMangling && {\n                  reserved: ['AbortSignal'],\n                  disableCharFreq: !isClient,\n                },\n              },\n            })\n          : (compiler: webpack.Compiler) => {\n              // @ts-ignore No typings yet\n              const { MinifyPlugin } =\n                require('./webpack/plugins/minify-webpack-plugin/src') as typeof import('./webpack/plugins/minify-webpack-plugin/src')\n              new MinifyPlugin({\n                noMangling,\n                disableCharFreq: !isClient,\n              }).apply(compiler)\n            },\n        // Minify CSS\n        // By default, Rspack uses LightningCSS for CSS minification.\n        // Rspack uses css-minimizer-plugin by default for compatibility.\n        isRspack &&\n        (process.env.__NEXT_TEST_MODE\n          ? config.experimental.useLightningcss\n          : config.experimental?.useLightningcss === undefined ||\n            config.experimental.useLightningcss)\n          ? new (getRspackCore().LightningCssMinimizerRspackPlugin)({\n              // CSS minimizer configuration\n              minimizerOptions: {\n                targets: supportedBrowsers,\n              },\n            })\n          : (compiler: webpack.Compiler) => {\n              const { CssMinimizerPlugin } =\n                require('./webpack/plugins/css-minimizer-plugin') as typeof import('./webpack/plugins/css-minimizer-plugin')\n              new CssMinimizerPlugin({\n                postcssOptions: {\n                  map: {\n                    // `inline: false` generates the source map in a separate file.\n                    // Otherwise, the CSS file is needlessly large.\n                    inline: false,\n                    // `annotation: false` skips appending the `sourceMappingURL`\n                    // to the end of the CSS file. Webpack already handles this.\n                    annotation: false,\n                  },\n                },\n              }).apply(compiler)\n            },\n      ],\n    },\n    context: dir,\n    // Kept as function to be backwards compatible\n    entry: async () => {\n      return {\n        ...(clientEntries ? clientEntries : {}),\n        ...entrypoints,\n      }\n    },\n    watchOptions: Object.freeze({\n      ...baseWatchOptions,\n      poll: config.watchOptions?.pollIntervalMs,\n    }),\n    output: {\n      // we must set publicPath to an empty value to override the default of\n      // auto which doesn't work in IE11\n      publicPath: `${\n        config.assetPrefix\n          ? config.assetPrefix.endsWith('/')\n            ? config.assetPrefix.slice(0, -1)\n            : config.assetPrefix\n          : ''\n      }/_next/`,\n      path: !dev && isNodeServer ? path.join(outputPath, 'chunks') : outputPath,\n      // On the server we don't use hashes\n      filename: isNodeOrEdgeCompilation\n        ? dev || isEdgeServer\n          ? `[name].js`\n          : `../[name].js`\n        : `static/chunks/${isDevFallback ? 'fallback/' : ''}[name]${\n            dev ? '' : '-[contenthash]'\n          }.js`,\n      library: isClient || isEdgeServer ? '_N_E' : undefined,\n      libraryTarget: isClient || isEdgeServer ? 'assign' : 'commonjs2',\n      hotUpdateChunkFilename: 'static/webpack/[id].[fullhash].hot-update.js',\n      hotUpdateMainFilename:\n        'static/webpack/[fullhash].[runtime].hot-update.json',\n      // This saves chunks with the name given via `import()`\n      chunkFilename: isNodeOrEdgeCompilation\n        ? '[name].js'\n        : `static/chunks/${isDevFallback ? 'fallback/' : ''}${\n            dev ? '[name]' : '[name].[contenthash]'\n          }.js`,\n      strictModuleExceptionHandling: true,\n      crossOriginLoading: crossOrigin,\n      // if `sources[number]` is not an absolute path, it's is resolved\n      // relative to the location of the source map file (https://tc39.es/source-map/#resolving-sources).\n      // However, Webpack's `resource-path` is relative to the app dir.\n      // TODO: Either `sourceRoot` should be populated with the root and then we can use `[resource-path]`\n      // or we need a way to resolve return `path.relative(sourceMapLocation, info.resourcePath)`\n      devtoolModuleFilenameTemplate: dev\n        ? '[absolute-resource-path]'\n        : undefined,\n      webassemblyModuleFilename: 'static/wasm/[modulehash].wasm',\n      hashFunction: 'xxhash64',\n      hashDigestLength: 16,\n    },\n    performance: false,\n    resolve: resolveConfig,\n    resolveLoader: {\n      // The loaders Next.js provides\n      alias: [\n        'error-loader',\n        'next-swc-loader',\n        'next-client-pages-loader',\n        'next-image-loader',\n        'next-metadata-image-loader',\n        'next-style-loader',\n        'next-flight-loader',\n        'next-flight-client-entry-loader',\n        'next-flight-action-entry-loader',\n        'next-flight-client-module-loader',\n        'next-flight-server-reference-proxy-loader',\n        'empty-loader',\n        'next-middleware-loader',\n        'next-edge-function-loader',\n        'next-edge-app-route-loader',\n        'next-edge-ssr-loader',\n        'next-middleware-asset-loader',\n        'next-middleware-wasm-loader',\n        'next-app-loader',\n        'next-route-loader',\n        'next-font-loader',\n        'next-invalid-import-error-loader',\n        'next-metadata-route-loader',\n        'modularize-import-loader',\n        'next-barrel-loader',\n        'next-error-browser-binary-loader',\n        'next-root-params-loader',\n      ].reduce(\n        (alias, loader) => {\n          // using multiple aliases to replace `resolveLoader.modules`\n          alias[loader] = path.join(__dirname, 'webpack', 'loaders', loader)\n\n          return alias\n        },\n        {} as Record<string, string>\n      ),\n      modules: [\n        'node_modules',\n        ...nodePathList, // Support for NODE_PATH environment variable\n      ],\n      plugins: [],\n    },\n    module: {\n      rules: [\n        {\n          issuerLayer: {\n            not: [WEBPACK_LAYERS.middleware, WEBPACK_LAYERS.instrument],\n          },\n          resolve: {\n            conditionNames: [\n              config.cacheComponents ? 'next-js' : '',\n              '...',\n            ].filter(Boolean) as string[],\n          },\n        },\n        // Alias server-only and client-only to proper exports based on bundling layers\n        {\n          issuerLayer: {\n            or: [\n              ...WEBPACK_LAYERS.GROUP.serverOnly,\n              ...WEBPACK_LAYERS.GROUP.neutralTarget,\n            ],\n          },\n          resolve: {\n            // Error on client-only but allow server-only\n            alias: createServerOnlyClientOnlyAliases(true),\n          },\n        },\n        {\n          issuerLayer: {\n            not: [\n              ...WEBPACK_LAYERS.GROUP.serverOnly,\n              ...WEBPACK_LAYERS.GROUP.neutralTarget,\n            ],\n          },\n          resolve: {\n            // Error on server-only but allow client-only\n            alias: createServerOnlyClientOnlyAliases(false),\n          },\n        },\n        // Detect server-only / client-only imports and error in build time\n        {\n          test: [\n            /^client-only$/,\n            /next[\\\\/]dist[\\\\/]compiled[\\\\/]client-only[\\\\/]error/,\n          ],\n          loader: 'next-invalid-import-error-loader',\n          issuerLayer: {\n            or: WEBPACK_LAYERS.GROUP.serverOnly,\n          },\n          options: {\n            message:\n              \"'client-only' cannot be imported from a Server Component module. It should only be used from a Client Component.\",\n          },\n        },\n        {\n          test: [\n            /^server-only$/,\n            /next[\\\\/]dist[\\\\/]compiled[\\\\/]server-only[\\\\/]index/,\n          ],\n          loader: 'next-invalid-import-error-loader',\n          issuerLayer: {\n            not: [\n              ...WEBPACK_LAYERS.GROUP.serverOnly,\n              ...WEBPACK_LAYERS.GROUP.neutralTarget,\n            ],\n          },\n          options: {\n            message:\n              \"'server-only' cannot be imported from a Client Component module. It should only be used from a Server Component.\",\n          },\n        },\n        // Potential the bundle introduced into middleware and api can be poisoned by client-only\n        // but not being used, so we disabled the `client-only` erroring on these layers.\n        // `server-only` is still available.\n        {\n          test: [\n            /^client-only$/,\n            /next[\\\\/]dist[\\\\/]compiled[\\\\/]client-only[\\\\/]error/,\n          ],\n          loader: 'empty-loader',\n          issuerLayer: {\n            or: WEBPACK_LAYERS.GROUP.neutralTarget,\n          },\n        },\n        ...(isNodeServer\n          ? []\n          : [\n              {\n                test: /[\\\\/].*?\\.node$/,\n                loader: 'next-error-browser-binary-loader',\n              },\n            ]),\n        ...(hasAppDir\n          ? [\n              {\n                // Make sure that AsyncLocalStorage module instance is shared between server and client\n                // layers.\n                layer: WEBPACK_LAYERS.shared,\n                test: asyncStoragesRegex,\n              },\n              // Convert metadata routes to separate layer\n              {\n                resourceQuery: new RegExp(\n                  WEBPACK_RESOURCE_QUERIES.metadataRoute\n                ),\n                layer: WEBPACK_LAYERS.reactServerComponents,\n              },\n              {\n                // Ensure that the app page module is in the client layers, this\n                // enables React to work correctly for RSC.\n                layer: WEBPACK_LAYERS.serverSideRendering,\n                test: /next[\\\\/]dist[\\\\/](esm[\\\\/])?server[\\\\/]route-modules[\\\\/]app-page[\\\\/]module/,\n              },\n              {\n                issuerLayer: isWebpackBundledLayer,\n                resolve: {\n                  alias: createNextApiEsmAliases(),\n                },\n              },\n              {\n                issuerLayer: shouldUseReactServerCondition,\n                resolve: {\n                  alias: createAppRouterApiAliases(true),\n                },\n              },\n              {\n                issuerLayer: isWebpackClientOnlyLayer,\n                resolve: {\n                  alias: createAppRouterApiAliases(false),\n                },\n              },\n            ]\n          : []),\n        ...(hasAppDir && !isClient\n          ? [\n              {\n                issuerLayer: shouldUseReactServerCondition,\n                test: {\n                  // Resolve it if it is a source code file, and it has NOT been\n                  // opted out of bundling.\n                  and: [\n                    aliasCodeConditionTest,\n                    {\n                      not: [optOutBundlingPackageRegex, asyncStoragesRegex],\n                    },\n                  ],\n                },\n                resourceQuery: {\n                  // Do not apply next-flight-loader to imports generated by the\n                  // next-metadata-image-loader, to avoid generating unnecessary\n                  // and conflicting entries in the flight client entry plugin.\n                  // These are already covered by the next-metadata-route-loader\n                  // entries.\n                  not: [\n                    new RegExp(WEBPACK_RESOURCE_QUERIES.metadata),\n                    new RegExp(WEBPACK_RESOURCE_QUERIES.metadataImageMeta),\n                  ],\n                },\n                resolve: {\n                  mainFields: getMainField(compilerType, true),\n                  conditionNames: reactServerConditionNames,\n                  // If missing the alias override here, the default alias will be used which aliases\n                  // react to the direct file path, not the package name. In that case the condition\n                  // will be ignored completely.\n                  alias: createVendoredReactAliases(bundledReactChannel, {\n                    // No server components profiling\n                    reactProductionProfiling,\n                    layer: WEBPACK_LAYERS.reactServerComponents,\n                    isBrowser: isClient,\n                    isEdgeServer,\n                  }),\n                },\n                use: 'next-flight-loader',\n              },\n            ]\n          : []),\n\n        ...getNextRootParamsRules({\n          isRootParamsEnabled:\n            config.experimental.rootParams ??\n            // `cacheComponents` implies `experimental.rootParams`.\n            config.cacheComponents ??\n            false,\n          isClient,\n          appDir,\n          pageExtensions,\n        }),\n\n        // TODO: FIXME: do NOT webpack 5 support with this\n        // x-ref: https://github.com/webpack/webpack/issues/11467\n        ...(!config.experimental.fullySpecified\n          ? [\n              {\n                test: /\\.m?js/,\n                resolve: {\n                  fullySpecified: false,\n                },\n              } as any,\n            ]\n          : []),\n        ...(hasAppDir && isEdgeServer\n          ? [\n              // The Edge bundle includes the server in its entrypoint, so it has to\n              // be in the SSR layer  here we convert the actual page request to\n              // the RSC layer via a webpack rule.\n              {\n                resourceQuery: new RegExp(\n                  WEBPACK_RESOURCE_QUERIES.edgeSSREntry\n                ),\n                layer: WEBPACK_LAYERS.reactServerComponents,\n              },\n            ]\n          : []),\n        ...(hasAppDir\n          ? [\n              {\n                // Alias react-dom for ReactDOM.preload usage.\n                // Alias react for switching between default set and share subset.\n                oneOf: [\n                  {\n                    issuerLayer: shouldUseReactServerCondition,\n                    test: {\n                      // Resolve it if it is a source code file, and it has NOT been\n                      // opted out of bundling.\n                      and: [\n                        aliasCodeConditionTest,\n                        {\n                          not: [optOutBundlingPackageRegex, asyncStoragesRegex],\n                        },\n                      ],\n                    },\n                    resolve: {\n                      // It needs `conditionNames` here to require the proper asset,\n                      // when react is acting as dependency of compiled/react-dom.\n                      alias: createVendoredReactAliases(bundledReactChannel, {\n                        reactProductionProfiling,\n                        layer: WEBPACK_LAYERS.reactServerComponents,\n                        isBrowser: isClient,\n                        isEdgeServer,\n                      }),\n                    },\n                  },\n                  {\n                    test: aliasCodeConditionTest,\n                    issuerLayer: WEBPACK_LAYERS.serverSideRendering,\n                    resolve: {\n                      alias: createVendoredReactAliases(bundledReactChannel, {\n                        reactProductionProfiling,\n                        layer: WEBPACK_LAYERS.serverSideRendering,\n                        isBrowser: isClient,\n                        isEdgeServer,\n                      }),\n                    },\n                  },\n                ],\n              },\n              {\n                test: aliasCodeConditionTest,\n                issuerLayer: WEBPACK_LAYERS.appPagesBrowser,\n                resolve: {\n                  alias: createVendoredReactAliases(bundledReactChannel, {\n                    reactProductionProfiling,\n                    layer: WEBPACK_LAYERS.appPagesBrowser,\n                    isBrowser: isClient,\n                    isEdgeServer,\n                  }),\n                },\n              },\n            ]\n          : []),\n        // Do not apply react-refresh-loader to node_modules for app router browser layer\n        ...(hasAppDir && dev && isClient\n          ? [\n              {\n                test: codeCondition.test,\n                exclude: [\n                  // exclude unchanged modules from react-refresh\n                  codeCondition.exclude,\n                  transpilePackagesRegex,\n                  precompileRegex,\n                ],\n                issuerLayer: WEBPACK_LAYERS.appPagesBrowser,\n                use: reactRefreshLoaders,\n                resolve: {\n                  mainFields: getMainField(compilerType, true),\n                },\n              },\n            ]\n          : []),\n        {\n          oneOf: [\n            {\n              ...codeCondition,\n              issuerLayer: WEBPACK_LAYERS.apiNode,\n              use: apiRoutesLayerLoaders,\n              // In Node.js, switch back to normal URL handling.\n              // We won't bundle `new URL()` cases in Node.js bundler layer.\n              parser: {\n                url: true,\n              },\n            },\n            {\n              ...codeCondition,\n              issuerLayer: WEBPACK_LAYERS.apiEdge,\n              use: apiRoutesLayerLoaders,\n              // In Edge runtime, we leave the url handling by default.\n              // The new URL assets will be converted into edge assets through assets loader.\n            },\n            {\n              test: codeCondition.test,\n              issuerLayer: WEBPACK_LAYERS.middleware,\n              use: middlewareLayerLoaders,\n              resolve: {\n                mainFields: getMainField(compilerType, true),\n                conditionNames: reactServerConditionNames,\n                alias: createVendoredReactAliases(bundledReactChannel, {\n                  reactProductionProfiling,\n                  layer: WEBPACK_LAYERS.middleware,\n                  isBrowser: isClient,\n                  isEdgeServer,\n                }),\n              },\n            },\n            {\n              test: codeCondition.test,\n              issuerLayer: WEBPACK_LAYERS.instrument,\n              use: instrumentLayerLoaders,\n              resolve: {\n                mainFields: getMainField(compilerType, true),\n                conditionNames: reactServerConditionNames,\n                alias: createVendoredReactAliases(bundledReactChannel, {\n                  reactProductionProfiling,\n                  layer: WEBPACK_LAYERS.instrument,\n                  isBrowser: isClient,\n                  isEdgeServer,\n                }),\n              },\n            },\n            ...(hasAppDir\n              ? [\n                  {\n                    test: codeCondition.test,\n                    issuerLayer: shouldUseReactServerCondition,\n                    exclude: asyncStoragesRegex,\n                    use: appServerLayerLoaders,\n                  },\n                  {\n                    test: codeCondition.test,\n                    resourceQuery: new RegExp(\n                      WEBPACK_RESOURCE_QUERIES.edgeSSREntry\n                    ),\n                    use: appServerLayerLoaders,\n                  },\n                  {\n                    test: codeCondition.test,\n                    issuerLayer: WEBPACK_LAYERS.appPagesBrowser,\n                    // Exclude the transpilation of the app layer due to compilation issues\n                    exclude: browserNonTranspileModules,\n                    use: appBrowserLayerLoaders,\n                    resolve: {\n                      mainFields: getMainField(compilerType, true),\n                    },\n                  },\n                  {\n                    test: codeCondition.test,\n                    issuerLayer: WEBPACK_LAYERS.serverSideRendering,\n                    exclude: asyncStoragesRegex,\n                    use: appSSRLayerLoaders,\n                    resolve: {\n                      mainFields: getMainField(compilerType, true),\n                    },\n                  },\n                ]\n              : []),\n            {\n              ...codeCondition,\n              use: [\n                ...reactRefreshLoaders,\n                defaultLoaders.babel,\n                reactCompilerLoader,\n              ].filter(Boolean),\n            },\n          ],\n        },\n\n        ...(!config.images.disableStaticImages\n          ? [\n              {\n                test: nextImageLoaderRegex,\n                loader: 'next-image-loader',\n                issuer: { not: regexLikeCss },\n                dependency: { not: ['url'] },\n                resourceQuery: {\n                  not: [\n                    new RegExp(WEBPACK_RESOURCE_QUERIES.metadata),\n                    new RegExp(WEBPACK_RESOURCE_QUERIES.metadataRoute),\n                    new RegExp(WEBPACK_RESOURCE_QUERIES.metadataImageMeta),\n                  ],\n                },\n                options: {\n                  isDev: dev,\n                  compilerType,\n                  basePath: config.basePath,\n                  assetPrefix: config.assetPrefix,\n                },\n              },\n            ]\n          : []),\n        ...(isEdgeServer\n          ? [\n              {\n                resolve: {\n                  fallback: {\n                    process: require.resolve('./polyfills/process'),\n                  },\n                },\n              },\n            ]\n          : isClient\n            ? [\n                {\n                  resolve: {\n                    fallback:\n                      config.experimental.fallbackNodePolyfills === false\n                        ? {\n                            assert: false,\n                            buffer: false,\n                            constants: false,\n                            crypto: false,\n                            domain: false,\n                            http: false,\n                            https: false,\n                            os: false,\n                            path: false,\n                            punycode: false,\n                            process: false,\n                            querystring: false,\n                            stream: false,\n                            string_decoder: false,\n                            sys: false,\n                            timers: false,\n                            tty: false,\n                            util: false,\n                            vm: false,\n                            zlib: false,\n                            events: false,\n                            setImmediate: false,\n                          }\n                        : {\n                            assert: require.resolve(\n                              'next/dist/compiled/assert'\n                            ),\n                            buffer: require.resolve(\n                              'next/dist/compiled/buffer'\n                            ),\n                            constants: require.resolve(\n                              'next/dist/compiled/constants-browserify'\n                            ),\n                            crypto: require.resolve(\n                              'next/dist/compiled/crypto-browserify'\n                            ),\n                            domain: require.resolve(\n                              'next/dist/compiled/domain-browser'\n                            ),\n                            http: require.resolve(\n                              'next/dist/compiled/stream-http'\n                            ),\n                            https: require.resolve(\n                              'next/dist/compiled/https-browserify'\n                            ),\n                            os: require.resolve(\n                              'next/dist/compiled/os-browserify'\n                            ),\n                            path: require.resolve(\n                              'next/dist/compiled/path-browserify'\n                            ),\n                            punycode: require.resolve(\n                              'next/dist/compiled/punycode'\n                            ),\n                            process: require.resolve('./polyfills/process'),\n                            // Handled in separate alias\n                            querystring: require.resolve(\n                              'next/dist/compiled/querystring-es3'\n                            ),\n                            stream: require.resolve(\n                              'next/dist/compiled/stream-browserify'\n                            ),\n                            string_decoder: require.resolve(\n                              'next/dist/compiled/string_decoder'\n                            ),\n                            sys: require.resolve('next/dist/compiled/util'),\n                            timers: require.resolve(\n                              'next/dist/compiled/timers-browserify'\n                            ),\n                            tty: require.resolve(\n                              'next/dist/compiled/tty-browserify'\n                            ),\n                            // Handled in separate alias\n                            // url: require.resolve('url'),\n                            util: require.resolve('next/dist/compiled/util'),\n                            vm: require.resolve(\n                              'next/dist/compiled/vm-browserify'\n                            ),\n                            zlib: require.resolve(\n                              'next/dist/compiled/browserify-zlib'\n                            ),\n                            events: require.resolve(\n                              'next/dist/compiled/events'\n                            ),\n                            setImmediate: require.resolve(\n                              'next/dist/compiled/setimmediate'\n                            ),\n                          },\n                  },\n                },\n              ]\n            : []),\n        {\n          // Mark `image-response.js` as side-effects free to make sure we can\n          // tree-shake it if not used.\n          test: /[\\\\/]next[\\\\/]dist[\\\\/](esm[\\\\/])?server[\\\\/]og[\\\\/]image-response\\.js/,\n          sideEffects: false,\n        },\n        // Mark the action-client-wrapper module as side-effects free to make sure\n        // the individual transformed module of client action can be tree-shaken.\n        // This will make modules processed by `next-flight-server-reference-proxy-loader` become side-effects free,\n        // then on client side the module ids will become tree-shakable.\n        // e.g. the output of client action module will look like:\n        // `export { a } from 'next-flight-server-reference-proxy-loader?id=idOfA&name=a!\n        // `export { b } from 'next-flight-server-reference-proxy-loader?id=idOfB&name=b!\n        {\n          test: /[\\\\/]next[\\\\/]dist[\\\\/](esm[\\\\/])?build[\\\\/]webpack[\\\\/]loaders[\\\\/]next-flight-loader[\\\\/]action-client-wrapper\\.js/,\n          sideEffects: false,\n        },\n        {\n          // This loader rule should be before other rules, as it can output code\n          // that still contains `\"use client\"` or `\"use server\"` statements that\n          // needs to be re-transformed by the RSC compilers.\n          // This loader rule works like a bridge between user's import and\n          // the target module behind a package's barrel file. It reads SWC's\n          // analysis result from the previous loader, and directly returns the\n          // code that only exports values that are asked by the user.\n          test: /__barrel_optimize__/,\n          use: ({ resourceQuery }: { resourceQuery: string }) => {\n            const names = (\n              resourceQuery.match(/\\?names=([^&]+)/)?.[1] || ''\n            ).split(',')\n\n            return [\n              {\n                loader: 'next-barrel-loader',\n                options: {\n                  names,\n                  swcCacheDir: path.join(\n                    dir,\n                    config?.distDir ?? '.next',\n                    'cache',\n                    'swc'\n                  ),\n                },\n                // This is part of the request value to serve as the module key.\n                // The barrel loader are no-op re-exported modules keyed by\n                // export names.\n                ident: 'next-barrel-loader:' + resourceQuery,\n              },\n            ]\n          },\n        },\n        {\n          resolve: {\n            alias: {\n              next: NEXT_PROJECT_ROOT,\n            },\n          },\n        },\n      ],\n    },\n    plugins: [\n      // In prod Webpack will already have a runtime for all reachable chunks.\n      // During dev, it will update the runtime as chunks come in which may be too late for Flight.\n      //\n      // TODO: Rspack currently does not support the hooks and chunk methods required by ForceCompleteRuntimePlugin.\n      dev && !isRspack && new ForceCompleteRuntimePlugin(),\n      isNodeServer &&\n        new bundler.NormalModuleReplacementPlugin(\n          /\\.\\/(.+)\\.shared-runtime$/,\n          function (resource) {\n            const moduleName = path.basename(\n              resource.request,\n              '.shared-runtime'\n            )\n            const layer = resource.contextInfo.issuerLayer\n            let runtime: string\n\n            switch (layer) {\n              case WEBPACK_LAYERS.serverSideRendering:\n              case WEBPACK_LAYERS.reactServerComponents:\n              case WEBPACK_LAYERS.appPagesBrowser:\n              case WEBPACK_LAYERS.actionBrowser:\n                runtime = 'app-page'\n                break\n              case null:\n              case undefined:\n              default:\n                runtime = 'pages'\n            }\n            resource.request = `next/dist/server/route-modules/${runtime}/vendored/contexts/${moduleName}`\n          }\n        ),\n      dev && new MemoryWithGcCachePlugin({ maxGenerations: 5 }),\n      dev &&\n        isClient &&\n        (isRspack\n          ? // eslint-disable-next-line\n            new (require('next/dist/compiled/@next/react-refresh-utils/dist/ReactRefreshRspackPlugin').default)()\n          : new ReactRefreshWebpackPlugin(webpack)),\n      // Makes sure `Buffer` and `process` are polyfilled in client and flight bundles (same behavior as webpack 4)\n      (isClient || isEdgeServer) &&\n        new bundler.ProvidePlugin({\n          // Buffer is used by getInlineScriptSource\n          Buffer: [require.resolve('buffer'), 'Buffer'],\n          // Avoid process being overridden when in web run time\n          ...(isClient && { process: [require.resolve('process')] }),\n        }),\n\n      new (getWebpackBundler().DefinePlugin)(\n        getDefineEnv({\n          isTurbopack: false,\n          config,\n          dev,\n          distDir,\n          projectPath: dir,\n          fetchCacheKeyPrefix,\n          hasRewrites,\n          isClient,\n          isEdgeServer,\n          isNodeServer,\n          middlewareMatchers,\n          omitNonDeterministic: isCompileMode,\n          rewrites,\n        })\n      ),\n      isClient &&\n        new ReactLoadablePlugin({\n          filename: REACT_LOADABLE_MANIFEST,\n          pagesDir,\n          appDir,\n          runtimeAsset: `server/${MIDDLEWARE_REACT_LOADABLE_MANIFEST}.js`,\n          dev,\n        }),\n      isNodeServer &&\n        !dev &&\n        new ((\n          require('./webpack/plugins/next-trace-entrypoints-plugin') as typeof import('./webpack/plugins/next-trace-entrypoints-plugin')\n        )\n          .TraceEntryPointsPlugin as typeof import('./webpack/plugins/next-trace-entrypoints-plugin').TraceEntryPointsPlugin)(\n          {\n            rootDir: dir,\n            appDir: appDir,\n            pagesDir: pagesDir,\n            esmExternals: config.experimental.esmExternals,\n            outputFileTracingRoot: config.outputFileTracingRoot,\n            appDirEnabled: hasAppDir,\n            traceIgnores: [],\n            compilerType,\n          }\n        ),\n      // Moment.js is an extremely popular library that bundles large locale files\n      // by default due to how Webpack interprets its code. This is a practical\n      // solution that requires the user to opt into importing specific locales.\n      // https://github.com/jmblog/how-to-optimize-momentjs-with-webpack\n      config.excludeDefaultMomentLocales &&\n        new bundler.IgnorePlugin({\n          resourceRegExp: /^\\.\\/locale$/,\n          contextRegExp: /moment$/,\n        }),\n      ...(dev\n        ? (() => {\n            // Even though require.cache is server only we have to clear assets from both compilations\n            // This is because the client compilation generates the build manifest that's used on the server side\n            const { NextJsRequireCacheHotReloader } =\n              require('./webpack/plugins/nextjs-require-cache-hot-reloader') as typeof import('./webpack/plugins/nextjs-require-cache-hot-reloader')\n            const devPlugins: any[] = [\n              new NextJsRequireCacheHotReloader({\n                serverComponents: hasAppDir,\n              }),\n            ]\n\n            if (isClient || isEdgeServer) {\n              devPlugins.push(new bundler.HotModuleReplacementPlugin())\n            }\n\n            return devPlugins\n          })()\n        : []),\n      !dev &&\n        new bundler.IgnorePlugin({\n          resourceRegExp: /react-is/,\n          contextRegExp: /next[\\\\/]dist[\\\\/]/,\n        }),\n      isNodeOrEdgeCompilation &&\n        new PagesManifestPlugin({\n          dev,\n          appDirEnabled: hasAppDir,\n          isEdgeRuntime: isEdgeServer,\n          distDir: !dev ? distDir : undefined,\n        }),\n      // MiddlewarePlugin should be after DefinePlugin so NEXT_PUBLIC_*\n      // replacement is done before its process.env.* handling\n      isEdgeServer &&\n        new MiddlewarePlugin({\n          dev,\n          sriEnabled: !dev && !!config.experimental.sri?.algorithm,\n          rewrites,\n          edgeEnvironments: {\n            __NEXT_BUILD_ID: buildId,\n            NEXT_SERVER_ACTIONS_ENCRYPTION_KEY: encryptionKey,\n            __NEXT_PREVIEW_MODE_ID: previewProps.previewModeId,\n            __NEXT_PREVIEW_MODE_SIGNING_KEY: previewProps.previewModeSigningKey,\n            __NEXT_PREVIEW_MODE_ENCRYPTION_KEY:\n              previewProps.previewModeEncryptionKey,\n          },\n        }),\n      isClient &&\n        new BuildManifestPlugin({\n          buildId,\n          rewrites,\n          isDevFallback,\n          appDirEnabled: hasAppDir,\n          clientRouterFilters,\n        }),\n      isRspack\n        ? new RspackProfilingPlugin({ runWebpackSpan })\n        : new ProfilingPlugin({ runWebpackSpan, rootDir: dir }),\n      new WellKnownErrorsPlugin(),\n      isClient &&\n        new CopyFilePlugin({\n          // file path to build output of `@next/polyfill-nomodule`\n          filePath: require.resolve('./polyfills/polyfill-nomodule'),\n          cacheKey: process.env.__NEXT_VERSION as string,\n          name: `static/chunks/polyfills${dev ? '' : '-[hash]'}.js`,\n          minimize: false,\n          info: {\n            [CLIENT_STATIC_FILES_RUNTIME_POLYFILLS_SYMBOL]: 1,\n            // This file is already minified\n            minimized: true,\n          },\n        }),\n      hasAppDir &&\n        (isClient\n          ? new ClientReferenceManifestPlugin({\n              dev,\n              appDir,\n              experimentalInlineCss: !!config.experimental.inlineCss,\n            })\n          : new FlightClientEntryPlugin({\n              appDir,\n              dev,\n              isEdgeServer,\n              encryptionKey,\n            })),\n      hasAppDir &&\n        !isClient &&\n        new NextTypesPlugin({\n          dir,\n          distDir: config.distDir,\n          appDir,\n          dev,\n          isEdgeServer,\n          pageExtensions: config.pageExtensions,\n          originalRewrites,\n          originalRedirects,\n        }),\n      !dev &&\n        isClient &&\n        !!config.experimental.sri?.algorithm &&\n        new SubresourceIntegrityPlugin(config.experimental.sri.algorithm),\n      isClient &&\n        new NextFontManifestPlugin({\n          appDir,\n        }),\n      !dev &&\n        isClient &&\n        config.experimental.cssChunking &&\n        (isRspack\n          ? new (getRspackCore().experiments.CssChunkingPlugin)({\n              strict: config.experimental.cssChunking === 'strict',\n              nextjs: true,\n            })\n          : new CssChunkingPlugin(\n              config.experimental.cssChunking === 'strict'\n            )),\n      telemetryPlugin,\n      !dev &&\n        isNodeServer &&\n        new (\n          require('./webpack/plugins/telemetry-plugin/telemetry-plugin') as typeof import('./webpack/plugins/telemetry-plugin/telemetry-plugin')\n        ).TelemetryPlugin(new Map()),\n      shouldEnableSlowModuleDetection &&\n        new (\n          require('./webpack/plugins/slow-module-detection-plugin') as typeof import('./webpack/plugins/slow-module-detection-plugin')\n        ).default({\n          compilerType,\n          ...config.experimental.slowModuleDetection!,\n        }),\n      isRspack &&\n        new (getRspackCore().NextExternalsPlugin)({\n          compilerType,\n          config,\n          optOutBundlingPackageRegex,\n          finalTranspilePackages,\n          dir,\n          defaultOverrides,\n        }),\n    ].filter(Boolean as any as ExcludesFalse),\n  }\n\n  // Support tsconfig and jsconfig baseUrl\n  // Only add the baseUrl if it's explicitly set in tsconfig/jsconfig\n  if (resolvedBaseUrl && !resolvedBaseUrl.isImplicit) {\n    webpackConfig.resolve?.modules?.push(resolvedBaseUrl.baseUrl)\n  }\n\n  // always add JsConfigPathsPlugin to allow hot-reloading\n  // if the config is added/removed\n  webpackConfig.resolve?.plugins?.unshift(\n    new JsConfigPathsPlugin(\n      jsConfig?.compilerOptions?.paths || {},\n      resolvedBaseUrl\n    )\n  )\n\n  const webpack5Config = webpackConfig as webpack.Configuration\n\n  if (isEdgeServer) {\n    webpack5Config.module?.rules?.unshift({\n      test: /\\.wasm$/,\n      loader: 'next-middleware-wasm-loader',\n      type: 'javascript/auto',\n      resourceQuery: /module/i,\n    })\n    webpack5Config.module?.rules?.unshift({\n      dependency: 'url',\n      loader: 'next-middleware-asset-loader',\n      type: 'javascript/auto',\n      layer: WEBPACK_LAYERS.edgeAsset,\n    })\n    webpack5Config.module?.rules?.unshift({\n      issuerLayer: WEBPACK_LAYERS.edgeAsset,\n      type: 'asset/source',\n    })\n  }\n\n  webpack5Config.experiments = {\n    layers: true,\n    cacheUnaffected: true,\n    buildHttp: Array.isArray(config.experimental.urlImports)\n      ? {\n          allowedUris: config.experimental.urlImports,\n          cacheLocation: path.join(dir, 'next.lock/data'),\n          lockfileLocation: path.join(dir, 'next.lock/lock.json'),\n        }\n      : config.experimental.urlImports\n        ? {\n            cacheLocation: path.join(dir, 'next.lock/data'),\n            lockfileLocation: path.join(dir, 'next.lock/lock.json'),\n            ...config.experimental.urlImports,\n          }\n        : undefined,\n  }\n\n  if (isRspack) {\n    // The layers experiment is now stable in Rspack\n    delete webpack5Config.experiments!.layers\n  }\n\n  webpack5Config.module!.parser = {\n    javascript: {\n      url: 'relative',\n    },\n  }\n  webpack5Config.module!.generator = {\n    asset: {\n      filename: 'static/media/[name].[hash:8][ext]',\n    },\n  }\n\n  if (!webpack5Config.output) {\n    webpack5Config.output = {}\n  }\n  if (isClient) {\n    webpack5Config.output.trustedTypes = 'nextjs#bundler'\n  }\n\n  if (isClient || isEdgeServer) {\n    webpack5Config.output.enabledLibraryTypes = ['assign']\n  }\n\n  // This enables managedPaths for all node_modules\n  // and also for the unplugged folder when using yarn pnp\n  // It also add the yarn cache to the immutable paths\n  webpack5Config.snapshot = {}\n  if (process.versions.pnp === '3') {\n    webpack5Config.snapshot.managedPaths = [\n      /^(.+?(?:[\\\\/]\\.yarn[\\\\/]unplugged[\\\\/][^\\\\/]+)?[\\\\/]node_modules[\\\\/])/,\n    ]\n  } else {\n    webpack5Config.snapshot.managedPaths = [/^(.+?[\\\\/]node_modules[\\\\/])/]\n  }\n  if (process.versions.pnp === '3') {\n    webpack5Config.snapshot.immutablePaths = [\n      /^(.+?[\\\\/]cache[\\\\/][^\\\\/]+\\.zip[\\\\/]node_modules[\\\\/])/,\n    ]\n  }\n\n  if (dev) {\n    if (!webpack5Config.optimization) {\n      webpack5Config.optimization = {}\n    }\n\n    // For Server Components, it's necessary to have provided exports collected\n    // to generate the correct flight manifest.\n    if (!hasAppDir) {\n      webpack5Config.optimization.providedExports = false\n    }\n    webpack5Config.optimization.usedExports = false\n  }\n\n  const configVars = JSON.stringify({\n    optimizePackageImports: config?.experimental?.optimizePackageImports,\n    crossOrigin: config.crossOrigin,\n    pageExtensions: pageExtensions,\n    trailingSlash: config.trailingSlash,\n    devIndicatorsPosition:\n      config.devIndicators === false\n        ? undefined\n        : config.devIndicators.position,\n    productionBrowserSourceMaps: !!config.productionBrowserSourceMaps,\n    reactStrictMode: config.reactStrictMode,\n    optimizeCss: config.experimental.optimizeCss,\n    nextScriptWorkers: config.experimental.nextScriptWorkers,\n    scrollRestoration: config.experimental.scrollRestoration,\n    basePath: config.basePath,\n    excludeDefaultMomentLocales: config.excludeDefaultMomentLocales,\n    assetPrefix: config.assetPrefix,\n    disableOptimizedLoading,\n    isEdgeRuntime: isEdgeServer,\n    reactProductionProfiling,\n    webpack: !!config.webpack,\n    hasRewrites,\n    swcLoader: useSWCLoader,\n    removeConsole: config.compiler?.removeConsole,\n    reactRemoveProperties: config.compiler?.reactRemoveProperties,\n    styledComponents: config.compiler?.styledComponents,\n    relay: config.compiler?.relay,\n    emotion: config.compiler?.emotion,\n    modularizeImports: config.modularizeImports,\n    imageLoaderFile: config.images.loaderFile,\n    clientTraceMetadata: config.experimental.clientTraceMetadata,\n    serverSourceMaps: config.experimental.serverSourceMaps,\n    serverReferenceHashSalt: encryptionKey,\n  })\n\n  const cache: any = {\n    type: 'filesystem',\n    // Disable memory cache in development in favor of our own MemoryWithGcCachePlugin.\n    maxMemoryGenerations: dev ? 0 : Infinity, // Infinity is default value for production in webpack currently.\n    // Includes:\n    //  - Next.js location on disk (some loaders use absolute paths and some resolve options depend on absolute paths)\n    //  - Next.js version\n    //  - next.config.js keys that affect compilation\n    version: `${__dirname}|${process.env.__NEXT_VERSION}|${configVars}`,\n    cacheDirectory: path.join(distDir, 'cache', 'webpack'),\n    // For production builds, it's more efficient to compress all cache files together instead of compression each one individually.\n    // So we disable compression here and allow the build runner to take care of compressing the cache as a whole.\n    // For local development, we still want to compress the cache files individually to avoid I/O bottlenecks\n    // as we are seeing 1~10 seconds of fs I/O time from user reports.\n    compression: dev ? 'gzip' : false,\n  }\n\n  // Adds `next.config.js` as a buildDependency when custom webpack config is provided\n  if (config.webpack && config.configFile) {\n    cache.buildDependencies = {\n      config: [config.configFile],\n      // We don't want to use the webpack default buildDependencies as we already include the next.js version\n      defaultWebpack: [],\n    }\n  } else {\n    cache.buildDependencies = {\n      // We don't want to use the webpack default buildDependencies as we already include the next.js version\n      defaultWebpack: [],\n    }\n  }\n  webpack5Config.plugins?.push((compiler) => {\n    compiler.hooks.done.tap('next-build-dependencies', (stats) => {\n      const buildDependencies = stats.compilation.buildDependencies\n      const nextPackage = path.dirname(require.resolve('next/package.json'))\n      // Remove all next.js build dependencies, they are already covered by the cacheVersion\n      // and next.js also imports the output files which leads to broken caching.\n      for (const dep of buildDependencies) {\n        if (dep.startsWith(nextPackage)) {\n          buildDependencies.delete(dep)\n        }\n      }\n    })\n  })\n\n  webpack5Config.cache = cache\n\n  if (process.env.NEXT_WEBPACK_LOGGING) {\n    const infra = process.env.NEXT_WEBPACK_LOGGING.includes('infrastructure')\n    const profileClient =\n      process.env.NEXT_WEBPACK_LOGGING.includes('profile-client')\n    const profileServer =\n      process.env.NEXT_WEBPACK_LOGGING.includes('profile-server')\n    const summaryClient =\n      process.env.NEXT_WEBPACK_LOGGING.includes('summary-client')\n    const summaryServer =\n      process.env.NEXT_WEBPACK_LOGGING.includes('summary-server')\n\n    const profile =\n      (profileClient && isClient) || (profileServer && isNodeOrEdgeCompilation)\n    const summary =\n      (summaryClient && isClient) || (summaryServer && isNodeOrEdgeCompilation)\n\n    const logDefault = !infra && !profile && !summary\n\n    if (logDefault || infra) {\n      webpack5Config.infrastructureLogging = {\n        level: 'verbose',\n        debug: /FileSystemInfo/,\n      }\n    }\n\n    if (logDefault || profile) {\n      webpack5Config.plugins!.push((compiler: webpack.Compiler) => {\n        compiler.hooks.done.tap('next-webpack-logging', (stats) => {\n          console.log(\n            stats.toString({\n              colors: true,\n              logging: logDefault ? 'log' : 'verbose',\n            })\n          )\n        })\n      })\n    } else if (summary) {\n      webpack5Config.plugins!.push((compiler: webpack.Compiler) => {\n        compiler.hooks.done.tap('next-webpack-logging', (stats) => {\n          console.log(\n            stats.toString({\n              preset: 'summary',\n              colors: true,\n              timings: true,\n            })\n          )\n        })\n      })\n    }\n\n    if (profile) {\n      const ProgressPlugin =\n        webpack.ProgressPlugin as unknown as typeof webpack.ProgressPlugin\n      webpack5Config.plugins!.push(\n        new ProgressPlugin({\n          profile: true,\n        })\n      )\n      webpack5Config.profile = true\n    }\n  }\n\n  webpackConfig = await buildConfiguration(webpackConfig, {\n    supportedBrowsers,\n    rootDirectory: dir,\n    customAppFile: pagesDir\n      ? new RegExp(escapeStringRegexp(path.join(pagesDir, `_app`)))\n      : undefined,\n    hasAppDir,\n    isDevelopment: dev,\n    isServer: isNodeOrEdgeCompilation,\n    isEdgeRuntime: isEdgeServer,\n    targetWeb: isClient || isEdgeServer,\n    assetPrefix: config.assetPrefix || '',\n    sassOptions: config.sassOptions,\n    productionBrowserSourceMaps: config.productionBrowserSourceMaps,\n    future: (config as any).future,\n    experimental: config.experimental,\n    disableStaticImages: config.images.disableStaticImages,\n    transpilePackages: config.transpilePackages,\n    serverSourceMaps: config.experimental.serverSourceMaps,\n  })\n\n  // @ts-ignore Cache exists\n  webpackConfig.cache.name = `${webpackConfig.name}-${webpackConfig.mode}${\n    isDevFallback ? '-fallback' : ''\n  }`\n\n  if (dev) {\n    if (webpackConfig.module) {\n      if (isRspack) {\n        ;(webpackConfig.module.unsafeCache as any) = NEGATIVE_UNSAFE_CACHE_REGEX\n      } else {\n        webpackConfig.module.unsafeCache = (module: any) =>\n          !UNSAFE_CACHE_REGEX.test(module.resource)\n      }\n    } else {\n      if (isRspack) {\n        ;(webpackConfig.module as any) = {\n          unsafeCache: NEGATIVE_UNSAFE_CACHE_REGEX,\n        }\n      } else {\n        webpackConfig.module = {\n          unsafeCache: (module: any) =>\n            !UNSAFE_CACHE_REGEX.test(module.resource),\n        }\n      }\n    }\n  }\n\n  let originalDevtool = webpackConfig.devtool\n  if (typeof config.webpack === 'function') {\n    const pluginCountBefore = webpackConfig.plugins?.length\n\n    webpackConfig = config.webpack(webpackConfig, {\n      dir,\n      dev,\n      isServer: isNodeOrEdgeCompilation,\n      buildId,\n      config,\n      defaultLoaders,\n      totalPages: Object.keys(entrypoints).length,\n      webpack: bundler,\n      ...(isNodeOrEdgeCompilation\n        ? {\n            nextRuntime: isEdgeServer ? 'edge' : 'nodejs',\n          }\n        : {}),\n    })\n\n    if (telemetryPlugin && pluginCountBefore) {\n      const pluginCountAfter = webpackConfig.plugins?.length\n      if (pluginCountAfter) {\n        const pluginsChanged = pluginCountAfter !== pluginCountBefore\n        telemetryPlugin.addUsage('webpackPlugins', pluginsChanged ? 1 : 0)\n      }\n    }\n\n    if (!webpackConfig) {\n      throw new Error(\n        `Webpack config is undefined. You may have forgot to return properly from within the \"webpack\" method of your ${config.configFileName}.\\n` +\n          'See more info here https://nextjs.org/docs/messages/undefined-webpack-config'\n      )\n    }\n\n    if (dev && originalDevtool !== webpackConfig.devtool) {\n      webpackConfig.devtool = originalDevtool\n      devtoolRevertWarning(originalDevtool)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-shadow\n    const webpack5Config = webpackConfig as webpack.Configuration\n\n    // disable lazy compilation of entries as next.js has it's own method here\n    if (webpack5Config.experiments?.lazyCompilation === true) {\n      webpack5Config.experiments.lazyCompilation = {\n        entries: false,\n      }\n    } else if (\n      typeof webpack5Config.experiments?.lazyCompilation === 'object' &&\n      webpack5Config.experiments.lazyCompilation.entries !== false\n    ) {\n      webpack5Config.experiments.lazyCompilation.entries = false\n    }\n\n    if (typeof (webpackConfig as any).then === 'function') {\n      console.warn(\n        '> Promise returned in next config. https://nextjs.org/docs/messages/promise-in-next-config'\n      )\n    }\n  }\n  const rules = webpackConfig.module?.rules || []\n\n  const customSvgRule = rules.find(\n    (rule): rule is webpack.RuleSetRule =>\n      (rule &&\n        typeof rule === 'object' &&\n        rule.loader !== 'next-image-loader' &&\n        'test' in rule &&\n        rule.test instanceof RegExp &&\n        rule.test.test('.svg')) ||\n      false\n  )\n\n  if (customSvgRule && hasAppDir) {\n    // Create React aliases for SVG components that were transformed using a\n    // custom webpack config with e.g. the `@svgr/webpack` loader, or the\n    // `babel-plugin-inline-react-svg` plugin.\n    rules.push({\n      test: customSvgRule.test,\n      oneOf: [\n        WEBPACK_LAYERS.reactServerComponents,\n        WEBPACK_LAYERS.serverSideRendering,\n        WEBPACK_LAYERS.appPagesBrowser,\n      ].map((layer) => ({\n        issuerLayer: layer,\n        resolve: {\n          alias: createVendoredReactAliases(bundledReactChannel, {\n            reactProductionProfiling,\n            layer,\n            isBrowser: isClient,\n            isEdgeServer,\n          }),\n        },\n      })),\n    })\n  }\n\n  if (!config.images.disableStaticImages) {\n    const nextImageRule = rules.find(\n      (rule) =>\n        rule && typeof rule === 'object' && rule.loader === 'next-image-loader'\n    )\n    if (customSvgRule && nextImageRule && typeof nextImageRule === 'object') {\n      // Exclude svg if the user already defined it in custom\n      // webpack config such as the `@svgr/webpack` loader, or\n      // the `babel-plugin-inline-react-svg` plugin.\n      nextImageRule.test = /\\.(png|jpg|jpeg|gif|webp|avif|ico|bmp)$/i\n    }\n  }\n\n  if (\n    config.experimental.craCompat &&\n    webpackConfig.module?.rules &&\n    webpackConfig.plugins\n  ) {\n    // CRA allows importing non-webpack handled files with file-loader\n    // these need to be the last rule to prevent catching other items\n    // https://github.com/facebook/create-react-app/blob/fddce8a9e21bf68f37054586deb0c8636a45f50b/packages/react-scripts/config/webpack.config.js#L594\n    const fileLoaderExclude = [/\\.(js|mjs|jsx|ts|tsx|json)$/]\n    const fileLoader = {\n      exclude: fileLoaderExclude,\n      issuer: fileLoaderExclude,\n      type: 'asset/resource',\n    }\n\n    const topRules = []\n    const innerRules = []\n\n    for (const rule of webpackConfig.module.rules) {\n      if (!rule || typeof rule !== 'object') continue\n      if (rule.resolve) {\n        topRules.push(rule)\n      } else {\n        if (\n          rule.oneOf &&\n          !(rule.test || rule.exclude || rule.resource || rule.issuer)\n        ) {\n          rule.oneOf.forEach((r) => innerRules.push(r))\n        } else {\n          innerRules.push(rule)\n        }\n      }\n    }\n\n    webpackConfig.module.rules = [\n      ...(topRules as any),\n      {\n        oneOf: [...innerRules, fileLoader],\n      },\n    ]\n  }\n\n  // Backwards compat with webpack-dev-middleware options object\n  if (typeof (config as any).webpackDevMiddleware === 'function') {\n    const options = (config as any).webpackDevMiddleware({\n      watchOptions: webpackConfig.watchOptions,\n    })\n    if (options.watchOptions) {\n      webpackConfig.watchOptions = options.watchOptions\n    }\n  }\n\n  function canMatchCss(rule: webpack.RuleSetCondition | undefined): boolean {\n    if (!rule) {\n      return false\n    }\n\n    const fileNames = [\n      '/tmp/NEXTJS_CSS_DETECTION_FILE.css',\n      '/tmp/NEXTJS_CSS_DETECTION_FILE.scss',\n      '/tmp/NEXTJS_CSS_DETECTION_FILE.sass',\n      '/tmp/NEXTJS_CSS_DETECTION_FILE.less',\n      '/tmp/NEXTJS_CSS_DETECTION_FILE.styl',\n    ]\n\n    if (rule instanceof RegExp && fileNames.some((input) => rule.test(input))) {\n      return true\n    }\n\n    if (typeof rule === 'function') {\n      if (\n        fileNames.some((input) => {\n          try {\n            if (rule(input)) {\n              return true\n            }\n          } catch {}\n          return false\n        })\n      ) {\n        return true\n      }\n    }\n\n    if (Array.isArray(rule) && rule.some(canMatchCss)) {\n      return true\n    }\n\n    return false\n  }\n\n  const hasUserCssConfig =\n    webpackConfig.module?.rules?.some(\n      (rule: any) => canMatchCss(rule.test) || canMatchCss(rule.include)\n    ) ?? false\n\n  if (hasUserCssConfig) {\n    // only show warning for one build\n    if (isNodeOrEdgeCompilation) {\n      console.warn(\n        yellow(bold('Warning: ')) +\n          bold(\n            'Built-in CSS support is being disabled due to custom CSS configuration being detected.\\n'\n          ) +\n          'See here for more info: https://nextjs.org/docs/messages/built-in-css-disabled\\n'\n      )\n    }\n\n    if (webpackConfig.module?.rules?.length) {\n      // Remove default CSS Loaders\n      webpackConfig.module.rules.forEach((r) => {\n        if (!r || typeof r !== 'object') return\n        if (Array.isArray(r.oneOf)) {\n          r.oneOf = r.oneOf.filter(\n            (o) => (o as any)[Symbol.for('__next_css_remove')] !== true\n          )\n        }\n      })\n    }\n    if (webpackConfig.plugins?.length) {\n      // Disable CSS Extraction Plugin\n      webpackConfig.plugins = webpackConfig.plugins.filter(\n        (p) => (p as any).__next_css_remove !== true\n      )\n    }\n    if (webpackConfig.optimization?.minimizer?.length) {\n      // Disable CSS Minifier\n      webpackConfig.optimization.minimizer =\n        webpackConfig.optimization.minimizer.filter(\n          (e) => (e as any).__next_css_remove !== true\n        )\n    }\n  }\n\n  // Inject missing React Refresh loaders so that development mode is fast:\n  if (dev && isClient) {\n    attachReactRefresh(webpackConfig, defaultLoaders.babel)\n  }\n\n  // Backwards compat for `main.js` entry key\n  // and setup of dependencies between entries\n  // we can't do that in the initial entry for\n  // backward-compat reasons\n  const originalEntry: any = webpackConfig.entry\n  if (typeof originalEntry !== 'undefined') {\n    const updatedEntry = async () => {\n      const entry: webpack.EntryObject =\n        typeof originalEntry === 'function'\n          ? await originalEntry()\n          : originalEntry\n      // Server compilation doesn't have main.js\n      if (\n        clientEntries &&\n        Array.isArray(entry['main.js']) &&\n        entry['main.js'].length > 0\n      ) {\n        const originalFile = clientEntries[\n          CLIENT_STATIC_FILES_RUNTIME_MAIN\n        ] as string\n        entry[CLIENT_STATIC_FILES_RUNTIME_MAIN] = [\n          ...entry['main.js'],\n          originalFile,\n        ]\n      }\n      delete entry['main.js']\n\n      for (const name of Object.keys(entry)) {\n        entry[name] = finalizeEntrypoint({\n          value: entry[name],\n          compilerType,\n          name,\n          hasAppDir,\n        })\n      }\n\n      return entry\n    }\n    // @ts-ignore webpack 5 typings needed\n    webpackConfig.entry = updatedEntry\n  }\n\n  if (!dev && typeof webpackConfig.entry === 'function') {\n    // entry is always a function\n    webpackConfig.entry = await webpackConfig.entry()\n  }\n\n  return webpackConfig\n}\n\nfunction getNextRootParamsRules({\n  isRootParamsEnabled,\n  isClient,\n  appDir,\n  pageExtensions,\n}: {\n  isRootParamsEnabled: boolean\n  isClient: boolean\n  appDir: string | undefined\n  pageExtensions: string[]\n}): webpack.RuleSetRule[] {\n  // Match resolved import of 'next/root-params'\n  const nextRootParamsModule = path.join(NEXT_PROJECT_ROOT, 'root-params.js')\n\n  const createInvalidImportRule = (message: string) => {\n    return {\n      resource: nextRootParamsModule,\n      loader: 'next-invalid-import-error-loader',\n      options: {\n        message,\n      } satisfies InvalidImportLoaderOpts,\n    } satisfies webpack.RuleSetRule\n  }\n\n  // Hard-error if the flag is not enabled, regardless of if we're on the server or on the client.\n  if (!isRootParamsEnabled) {\n    return [\n      createInvalidImportRule(\n        \"'next/root-params' can only be imported when `experimental.rootParams` is enabled.\"\n      ),\n    ]\n  }\n\n  // If there's no app-dir (and thus no layouts), there's no sensible way to use 'next/root-params',\n  // because we wouldn't generate any getters.\n  if (!appDir) {\n    return [\n      createInvalidImportRule(\n        \"'next/root-params' can only be used with the App Directory.\"\n      ),\n    ]\n  }\n\n  // In general, the compiler should prevent importing 'next/root-params' from client modules, but it doesn't catch everything.\n  // If an import slips through our validation, make it error.\n  const invalidClientImportRule = createInvalidImportRule(\n    \"'next/root-params' cannot be imported from a Client Component module. It should only be used from a Server Component.\"\n  )\n\n  // in the browser compilation we can skip the server rules, because we know all imports will be invalid.\n  if (isClient) {\n    return [invalidClientImportRule]\n  }\n\n  return [\n    {\n      oneOf: [\n        {\n          resource: nextRootParamsModule,\n          issuerLayer: shouldUseReactServerCondition as (\n            layer: string\n          ) => boolean,\n          loader: 'next-root-params-loader',\n          options: {\n            appDir,\n            pageExtensions,\n          } satisfies RootParamsLoaderOpts,\n        },\n        // if the rule above didn't match, we're in the SSR layer (or something else that isn't server-only).\n        invalidClientImportRule,\n      ],\n    },\n  ]\n}\n"],"names":["React","ReactRefreshWebpackPlugin","yellow","bold","crypto","webpack","path","getDefineEnv","escapeStringRegexp","WEBPACK_LAYERS","WEBPACK_RESOURCE_QUERIES","isWebpackBundledLayer","isWebpackClientOnlyLayer","shouldUseReactServerCondition","isWebpackDefaultLayer","RSPACK_DEFAULT_LAYERS_REGEX","CLIENT_STATIC_FILES_RUNTIME_MAIN","CLIENT_STATIC_FILES_RUNTIME_MAIN_APP","CLIENT_STATIC_FILES_RUNTIME_POLYFILLS_SYMBOL","CLIENT_STATIC_FILES_RUNTIME_REACT_REFRESH","CLIENT_STATIC_FILES_RUNTIME_WEBPACK","MIDDLEWARE_REACT_LOADABLE_MANIFEST","REACT_LOADABLE_MANIFEST","SERVER_DIRECTORY","COMPILER_NAMES","execOnce","finalizeEntrypoint","Log","buildConfiguration","ForceCompleteRuntimePlugin","MiddlewarePlugin","getEdgePolyfilledModules","handleWebpackExternalForEdgeRuntime","BuildManifestPlugin","JsConfigPathsPlugin","PagesManifestPlugin","ProfilingPlugin","ReactLoadablePlugin","WellKnownErrorsPlugin","regexLikeCss","CopyFilePlugin","ClientReferenceManifestPlugin","FlightClientEntryPlugin","NextFlightClientEntryPlugin","RspackFlightClientEntryPlugin","NextTypesPlugin","loadJsConfig","SubresourceIntegrityPlugin","NextFontManifestPlugin","getSupportedBrowsers","MemoryWithGcCachePlugin","getBabelConfigFile","needsExperimentalReact","isResourceInPackages","makeExternalHandler","getMainField","edgeConditionName","OptionalPeerDependencyResolverPlugin","createWebpackAliases","createServerOnlyClientOnlyAliases","createVendoredReactAliases","createNextApiEsmAliases","createAppRouterApiAliases","hasCustomExportOutput","CssChunkingPlugin","getBabelLoader","getReactCompilerLoader","NEXT_PROJECT_ROOT","NEXT_PROJECT_ROOT_DIST_CLIENT","getRspackCore","RspackProfilingPlugin","getWebpackBundler","defaultOverrides","EXTERNAL_PACKAGES","require","DEFAULT_TRANSPILED_PACKAGES","parseInt","version","Error","babelIncludeRegexes","browserNonTranspileModules","precompileRegex","asyncStoragesRegex","nodePathList","process","env","NODE_PATH","split","platform","filter","p","baseWatchOptions","Object","freeze","aggregateTimeout","ignored","isModuleCSS","module","type","devtoolRevertWarning","devtool","console","warn","loggedSwcDisabled","loggedIgnoredCompilerOptions","reactRefreshLoaderName","getReactRefreshLoader","NEXT_RSPACK","resolve","attachReactRefresh","webpackConfig","targetLoader","reactRefreshLoader","rules","forEach","rule","curr","use","Array","isArray","some","r","idx","findIndex","splice","NODE_RESOLVE_OPTIONS","dependencyType","modules","fallback","exportsFields","importsFields","conditionNames","descriptionFiles","extensions","enforceExtensions","symlinks","mainFields","mainFiles","roots","fullySpecified","preferRelative","preferAbsolute","restrictions","NODE_BASE_RESOLVE_OPTIONS","alias","NODE_ESM_RESOLVE_OPTIONS","NODE_BASE_ESM_RESOLVE_OPTIONS","nextImageLoaderRegex","loadProjectInfo","dir","config","dev","jsConfig","jsConfigPath","resolvedBaseUrl","supportedBrowsers","hasExternalOtelApiPackage","UNSAFE_CACHE_REGEX","NEGATIVE_UNSAFE_CACHE_REGEX","RegExp","source","getCacheDirectories","configs","Set","map","cfg","cache","cacheDirectory","getBaseWebpackConfig","buildId","encryptionKey","compilerType","entrypoints","isDevFallback","pagesDir","reactProductionProfiling","rewrites","originalRewrites","originalRedirects","runWebpackSpan","appDir","middlewareMatchers","noMangling","clientRouterFilters","fetchCacheKeyPrefix","isCompileMode","previewProps","webpack5Config","bundler","isClient","client","isEdgeServer","edgeServer","isNodeServer","server","isRspack","Boolean","BUILTIN_FLIGHT_CLIENT_ENTRY_PLUGIN","isNodeOrEdgeCompilation","hasRewrites","beforeFiles","length","afterFiles","hasAppDir","disableOptimizedLoading","bundledReactChannel","babelConfigFile","distDir","join","useSWCLoader","experimental","forceSwcTransforms","SWCBinaryTarget","undefined","binaryTarget","getBinaryMetadata","target","info","relative","finalTranspilePackages","transpilePackages","concat","pkg","optimizePackageImports","includes","push","compiler","excludeCache","exclude","excludePath","cached","shouldExclude","test","shouldIncludeExternalDirs","externalDir","codeCondition","or","include","babelLoader","reactCompiler","reactCompilerLoader","swcTraceProfilingInitialized","getSwcLoader","extraOptions","swcTraceProfiling","initCustomTraceSubscriber","Date","now","useBuiltinSwcLoader","BUILTIN_SWC_LOADER","loader","options","isServer","rootDir","hasReactRefresh","swcCacheDir","serverReferenceHashSalt","pnp","versions","optimizeServerReact","modularizeImports","decorators","compilerOptions","experimentalDecorators","emitDecoratorMetadata","regeneratorRuntimePath","nextConfig","swcServerLayerLoader","serverComponents","bundleLayer","reactServerComponents","esm","swcSSRLayerLoader","serverSideRendering","swcBrowserLayerLoader","appPagesBrowser","swcDefaultLoader","defaultLoaders","babel","appServerLayerLoaders","instrumentLayerLoaders","middlewareLayerLoaders","middleware","reactRefreshLoaders","createClientLayerLoader","isBrowserLayer","reactRefresh","appBrowserLayerLoaders","appSSRLayerLoaders","apiRoutesLayerLoaders","apiNode","pageExtensions","outputPath","reactServerConditionNames","reactRefreshEntry","clientEntries","replace","resolveConfig","extensionAlias","plugins","tsConfig","configFile","nextFrameworkPaths","topLevelFrameworkPaths","visitedFrameworkPackages","addPackagePath","packageName","relativeToPath","paths","has","add","packageJsonPath","directory","dependencies","name","keys","_","crossOrigin","serverExternalPackages","externalPackageConflicts","optOutBundlingPackages","optOutBundlingPackageRegex","transpilePackagesRegex","handleExternals","transpiledPackages","pageExtensionsRegex","aliasCodeConditionTest","builtinModules","bunExternals","shouldEnableSlowModuleDetection","slowModuleDetection","getParallelism","override","Number","NEXT_WEBPACK_PARALLELISM","telemetryPlugin","TelemetryPlugin","Map","relay","styledComponents","reactRemoveProperties","removeConsole","jsxImportSource","emotion","skipProxyUrlNormalize","skipTrailingSlashRedirect","esmExternals","parallelism","externalsPresets","node","externals","context","request","contextInfo","getResolve","issuerLayer","resolveFunction","resolveContext","requestToResolve","Promise","reject","err","result","resolveData","isEsm","descriptionFileData","optimization","emitOnErrors","checkWasmTypes","nodeEnv","splitChunks","extractRootNodeModule","modulePath","regex","match","cacheGroups","vendor","chunks","reuseExistingChunk","minSize","minChunks","maxAsyncRequests","maxInitialRequests","moduleId","nameForCondition","rootModule","hash","createHash","update","digest","default","defaultVendors","filename","frameworkCacheGroup","layer","resource","pkgPath","startsWith","priority","enforce","libCacheGroup","size","updateHash","libIdent","substring","chunk","framework","lib","runtimeChunk","minimize","serverMinification","minimizer","SwcJsMinimizerRspackPlugin","minimizerOptions","compress","inline","global_defs","mangle","reserved","disableCharFreq","MinifyPlugin","apply","__NEXT_TEST_MODE","useLightningcss","LightningCssMinimizerRspackPlugin","targets","CssMinimizerPlugin","postcssOptions","annotation","entry","watchOptions","poll","pollIntervalMs","output","publicPath","assetPrefix","endsWith","slice","library","libraryTarget","hotUpdateChunkFilename","hotUpdateMainFilename","chunkFilename","strictModuleExceptionHandling","crossOriginLoading","devtoolModuleFilenameTemplate","webassemblyModuleFilename","hashFunction","hashDigestLength","performance","resolveLoader","reduce","__dirname","not","instrument","cacheComponents","GROUP","serverOnly","neutralTarget","message","shared","resourceQuery","metadataRoute","and","metadata","metadataImageMeta","isBrowser","getNextRootParamsRules","isRootParamsEnabled","rootParams","edgeSSREntry","oneOf","parser","url","apiEdge","images","disableStaticImages","issuer","dependency","isDev","basePath","fallbackNodePolyfills","assert","buffer","constants","domain","http","https","os","punycode","querystring","stream","string_decoder","sys","timers","tty","util","vm","zlib","events","setImmediate","sideEffects","names","ident","next","NormalModuleReplacementPlugin","moduleName","basename","runtime","actionBrowser","maxGenerations","ProvidePlugin","Buffer","DefinePlugin","isTurbopack","projectPath","omitNonDeterministic","runtimeAsset","TraceEntryPointsPlugin","outputFileTracingRoot","appDirEnabled","traceIgnores","excludeDefaultMomentLocales","IgnorePlugin","resourceRegExp","contextRegExp","NextJsRequireCacheHotReloader","devPlugins","HotModuleReplacementPlugin","isEdgeRuntime","sriEnabled","sri","algorithm","edgeEnvironments","__NEXT_BUILD_ID","NEXT_SERVER_ACTIONS_ENCRYPTION_KEY","__NEXT_PREVIEW_MODE_ID","previewModeId","__NEXT_PREVIEW_MODE_SIGNING_KEY","previewModeSigningKey","__NEXT_PREVIEW_MODE_ENCRYPTION_KEY","previewModeEncryptionKey","filePath","cacheKey","__NEXT_VERSION","minimized","experimentalInlineCss","inlineCss","cssChunking","experiments","strict","nextjs","NextExternalsPlugin","isImplicit","baseUrl","unshift","edgeAsset","layers","cacheUnaffected","buildHttp","urlImports","allowedUris","cacheLocation","lockfileLocation","javascript","generator","asset","trustedTypes","enabledLibraryTypes","snapshot","managedPaths","immutablePaths","providedExports","usedExports","configVars","JSON","stringify","trailingSlash","devIndicatorsPosition","devIndicators","position","productionBrowserSourceMaps","reactStrictMode","optimizeCss","nextScriptWorkers","scrollRestoration","swcLoader","imageLoaderFile","loaderFile","clientTraceMetadata","serverSourceMaps","maxMemoryGenerations","Infinity","compression","buildDependencies","defaultWebpack","hooks","done","tap","stats","compilation","nextPackage","dirname","dep","delete","NEXT_WEBPACK_LOGGING","infra","profileClient","profileServer","summaryClient","summaryServer","profile","summary","logDefault","infrastructureLogging","level","debug","log","toString","colors","logging","preset","timings","ProgressPlugin","rootDirectory","customAppFile","isDevelopment","targetWeb","sassOptions","future","mode","unsafeCache","originalDevtool","pluginCountBefore","totalPages","nextRuntime","pluginCountAfter","pluginsChanged","addUsage","configFileName","lazyCompilation","entries","then","customSvgRule","find","nextImageRule","craCompat","fileLoaderExclude","fileLoader","topRules","innerRules","webpackDevMiddleware","canMatchCss","fileNames","input","hasUserCssConfig","o","Symbol","for","__next_css_remove","e","originalEntry","updatedEntry","originalFile","value","nextRootParamsModule","createInvalidImportRule","invalidClientImportRule"],"mappings":"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","ignoreList":[0]}